module.exports=function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=29)}([function(t,e){t.exports=require("path")},function(t,e){t.exports=require("assert")},function(module,exports,__webpack_require__){"use strict";const Default=eval("require")("./language.json");let Lang,Config,User;const langRoot="../../../languages/";try{Config=eval("require")(`${langRoot}config.json`),User=eval("require")(`${langRoot}${Config.default.client}-client.json`)}catch(t){console.log("TODO: Err.System.Notification")}Lang=User instanceof Object?Object.assign({},Default,User):Default,module.exports=Lang,module.exports.args=function(t,e){Array.isArray(e)||(e=[e]);for(var n in e)t=t.replace(`{${n}}`,e[0]);return t},module.exports.auto=function(t,e,n){$(e).html($(e).html().replace(/\{\{(.*?)\}\}/g,function(e,o){return n?Lang[n][t][o]:Lang[t][o]}))},module.exports.replace=function(t,e,n){return t.replace(/\{\{(.*?)\}\}/g,function(t,o){return n?Lang[n][e][o]:Lang[e][o]})}},function(t,e){t.exports=require("electron")},function(t,e,n){"use strict";function o(t){if(!(t instanceof Object))throw new TypeError(s.error.options_must_be_object);o._init(t)}const i=n(0),r=n(7),s=n(2).Tools.Window,{app:a,BrowserWindow:l,ipcMain:c,dialog:p,nativeImage:h}=n(3);let u,d;const f={width:900,height:600,maximizable:!1,resizable:!1,webPreferences:{devTools:!1},icon:h.createFromPath(i.join(__dirname,"../source/image/favicon.png"))};o._init=function(t){d=f,t&&Object.assign(d,t)},o._start=function(){(u=new l(d)).loadURL(r.format({pathname:i.join(__dirname,"../source/html/index.htm"),protocol:"file:",slashes:!0})),u.on("closed",function(){u=null}),c.on("window-size",function(t,e){var n=d.width,o=d.height;n>e.width&&o>e.height&&n!=e.width&&u.setSize(n-(e.width-n),o-(e.height-o))})},o.prototype.start=function(){a.on("ready",o._start),a.on("window-all-closed",function(){"darwin"!==process.platform&&a.quit()}),a.on("activate",()=>{null===u&&o._start()})},t.exports=o},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("os")},function(t,e){t.exports=require("url")},function(module,exports,__webpack_require__){"use strict";function Loader(t,e){if(!(this instanceof Loader))return new Loader;this.locker=new Lock,this.element=t,this.type=e,this.events=[]}function upperFirst(t){return t[0].toUpperCase()+t.slice(1)}const{ipcRenderer:ipcRenderer}=__webpack_require__(3),Remote=__webpack_require__(3).remote,FileSystem=__webpack_require__(5),Path=__webpack_require__(0),EventBind=__webpack_require__(9),Menu=Remote.Menu,Windows=Remote.getCurrentWindow(),Langs=__webpack_require__(2),Lang=Langs.Browser.Loader,Lock=Core.utils.Lock;Loader.init=function(t){const e=new Loader(document.body,"page");t.loader=e,e.node=t,t.eventbind||(t.eventbind=new EventBind(t)),e._find()},Loader.reload=function(){location.reload()},Loader.prototype._find=function(){$(this.element).is("[page]")?(this.type="page",this._load()):$(this.element).is("[module]")&&(this.type="module",this._load());const t=this;$(this.element).children().each(function(){t.element=this,t._find()})},Loader.prototype._load=async function(){const t=this._getAttribute($(this.element)),e="page"==this.type?`page/${t.page[0]}/${t.page[1]}.htm`:`module/${t.category}/${t.module}.htm`,n=Path.join(`${__dirname}/../source/html/${e}`),o=t.tag?t.tag:this.element;if(t.active){const e=await this.locker.lock();try{const i=await this._readFile(n);return await this._render(o,i,t)}finally{e()}}},Loader.prototype._readFile=async function(t){try{return await FileSystem.readFileSync(t,"utf8")}catch(e){throw new TypeError(Langs.args(Lang.error.file_not_found,t))}},Loader.prototype._getAttribute=function(t){let e={};return $.each(t.get(0).attributes,function(){"page"==this.name?e[this.name]=this.value.split(/_(.+)/):e[this.name]=this.value}),e},Loader.prototype._render=async function _render(element,data,attr){const dom=$(data);for(let t=0;t<dom.length;++t)this.element=dom[t],$(dom[t]).is("toggle")&&(data=await this._toggle(element,dom,$(data),attr,t)),this._find(),$(dom[t]).is("include")&&this._include(element,dom[t]);data=this._replace(data,attr),$(element).html(data);const req=$(element).find("require"),tri=$(element).find("trigger");req.length&&eval("require")(req.attr("src"));const self=this;tri.length&&eval(`(async function() { ${tri.attr("script")} })();`);const el=$(element).find("print");el.length&&this._print(el)},Loader.prototype._toggle=async function(t,e,n,o,i){const r=$("<p></p>").append(e[i]),s=$(e[i]).attr("script").split("::"),a=$(e[i]).attr("on"),l=$(e[i]).attr("cls");let c=0;const p=this;await async function(){return await p.node._call(s[1],s[0])}()||(c^=1);let h=r.children("toggle").find(`[cls="${l}"]`);const u=h.eq(1^c).children("[click]");for(let e=0;e<$(h).length;++e){const n=$(h[e]).html(),i=$(n);for(let r=0;r<i.length;++r)if(this.element=i[r],$(i[r]).is("toggle")){const s=await this._toggle(t,i,$(n),o,r);$(h[e]).eq(r).html(s)}}let d;if(a){const e=a.split("::");this._event(e[0],e[1],h,function(){this.element=t,d=n.map(function(){return this.outerHTML}).get(),p._render(t,d.join("\r\n"),o)})}u&&$(t).unbind().bind("click","[click]",async function(e){if($(e.target).attr("click")){const i=$(e.target).attr("click").split("::");i&&await p.node._call(i[1],i[0]),d=n.map(function(){return this.outerHTML}).get(),p._render(t,d.join("\r\n"),o)}}),h.eq(c).remove();let f="";for(let t=0;t<e.length;t++)f+=t===i?r.html():$(e[t]).prop("outerHTML")||"";return f},Loader.prototype._include=async function(t,e){const n=this,o=Path.join(__dirname,$(e).attr("src"));!async function(){const e=await n._readFile(o);$(t).append(`<script type="text/javascript">${e}<\/script>`)}()},Loader.prototype._replace=function(t,e){return e.page?Langs.replace(t,upperFirst(e.page[1]),upperFirst(e.page[0])):Langs.replace(t,upperFirst(e.module),upperFirst(e.category))},Loader.prototype._print=async function(t){let e;for(let n=0;n<t.length;n++){const o=$(t[n]),i=o.html().split("::"),r=Object.assign({},i.slice(2));if(o.is("[on]"))await this.node._on(i[1],i[0],o);else{if(o.is("[emit]"))e=await this.node._emit(i[1],i[0]);else try{e=await this.node._call(i[1],i[0],r)}catch(t){console.log(t),e=o.html()}o.html(e)}}},Loader.prototype._event=function(t,e,n,o){this.events[t]||(this.events[t]=[]);const i=this.node[t].on(e,o);i._events[e]=i._events[e].filter((t,e,n)=>n.includes(t)==e)},ipcRenderer.send("window-size",{width:window.innerWidth,height:window.innerHeight});const SelectionText=Menu.buildFromTemplate([{label:Lang.context_menu.copy,role:"copy"},{type:"separator"},{label:Lang.context_menu.selectall,role:"selectall"}]),SelectionInput=Menu.buildFromTemplate([{label:Lang.context_menu.undo,role:"undo"},{label:Lang.context_menu.redo,role:"redo"},{type:"separator"},{label:Lang.context_menu.cut,role:"cut"},{label:Lang.context_menu.copy,role:"copy"},{label:Lang.context_menu.paste,role:"paste"},{type:"separator"},{label:Lang.context_menu.selectall,role:"selectall"}]);Windows.webContents.on("context-menu",(t,e)=>{const{isEditable:n}=e;n&&SelectionInput.popup(Windows)}),window.oncontextmenu=function(t){""!=window.getSelection()&&2===t.button&&SelectionText.popup(Windows)},document.addEventListener("keydown",function(t){t.ctrlKey&&t.shiftKey&&123===t.which?Windows.toggleDevTools():t.ctrlKey&&t.shiftKey&&116===t.which&&location.reload()}),["drop","dragover"].map(t=>{window.addEventListener(t,t=>(t.preventDefault(),!1),!1)}),module.exports=Loader},function(module,exports,__webpack_require__){"use strict";function EventBind(t){if(!(this instanceof EventBind))return new EventBind(t);this.node=t,t.eventbind=this,this.init()}function checkAddress(t,e,n){const o=$(t.target),i=o.siblings("p"),r=o.val();if(i.html("").removeClass("error"),highlightInput(o,0),"focusin"!==t.type)try{if(r){const t=Address.fromString(r);if(e&&!e.includes(t.getScriptType()))return i.html(n).addClass("error"),void highlightInput(o,1,1);highlightInput(o,1,0)}}catch(n){i.html("Invalid WMCC Address").addClass("error"),highlightInput(o,1,1)}}function isNumeric(t){return!isNaN(parseFloat(t))&&isFinite(t)}function toNumeric(t){return!!isNumeric(t)&&parseFloat(t)}function waitElement(t,e){$(t).length?e($(t)):waitElement(t,e)}function highlightInput(t,e,n){const o=["focus","error"];Array.isArray(t)||(t=[t]);for(let i=0;i<t.length;i++)switch(e){case 0:for(let e=0;e<o.length;e++)t[i].removeClass(o[e]);break;case 1:t[i].addClass(o[n])}}function swapCoin(t){t.blur(function(){let e,n;const o=t.attr("coin");switch(n=toNumeric(t.val()),o){case"wmcc":e=t.siblings('[coin="btc"]');try{n=(n=(n=new BigNum(n)).div(1e4)).toNumber()}catch(t){}break;case"btc":e=t.siblings('[coin="wmcc"]');try{n=(n=(n=new BigNum(n)).mul(1e4)).toNumber()}catch(t){}}let i=[e,e.next()];highlightInput(i,1,0),n||(n="",0===parseFloat(t.val())&&(t.val(""),i.push(t,t.next())),highlightInput(i,0)),e.val(n)})}function getSend(t){const e=t.parent().parent(),n=e.find(".address:first"),o=e.find('input[coin="wmcc"]');return!(!n.val()||!o.val()||n.hasClass("error")||o.hasClass("error"))&&{addr:n.val(),val:o.val()}}const Address=Core.primitives.Address,Util=Core.utils.util,BN=Core.crypto.BN,Calendar=eval("require")("../lib/vendor").calendar,Langs=__webpack_require__(2),{clipboard:clipboard}=__webpack_require__(3);let target={},calendar,calendars=null;BigNum.config({DECIMAL_PLACES:7});const Event=[["click","menubutton, tabbutton, menuhidden","_toggleActive"],["click",".flaticon-copy","_iconCopy"],["click",".flaticon-paste","_iconPaste"],["focus",".r_calendar","_calendar"],["mouseenter mouseleave focus blur",".r_togglePassword","_togglePassword"],["keyup change",".r_maxbuffer","_maxBuffer"],["focus",".r_maxsize","_maxSize"],["keydown change",".r_isname","_isName"],["keydown change",".r_digitdash","_digitdash"],["keydown change",".r_fixedNumber","_fixedNumber"],["click",".r_secret_insert","_insertSecret"],["click",".r_wallet_remove","_removeSecret"],["focus blur",".r_checkAddress","_checkAddress"],["focus blur",".r_checkPubKeyHashAddress","_checkPubKeyHashAddress"],["click",".r_walletManageAddress","_walletManageAddress"],["keyup change",".r_checkAmount","_checkAmount"],["click",".r_copyAddress","_copyAddress"],["click",".r_addAddress","_addAddress"],["click",".r_deleteAddress","_deleteAddress"],["click",".r_walletGetHistory","_walletGetHistory"],["click keyup",".r_expSearch","_expSearch"],["click",".r_goToExp","_goToExp"],["click",".r_goExpHome","_goExpHome"],["click",".r_getExpAdressTransactions","_getExpAdressTransactions"],["click",".r_genGotoAddress","_genGotoAddress"],["click",".r_genGotoAddresses","_genGotoAddresses"],["click keyup",".r_genSearchAddress","_genSearchAddress"],["click keyup",".r_menuLogout","_menuLogout"]];EventBind.prototype.init=function(){const t=this;for(let e in Event)$(document).on(Event[e][0],Event[e][1],function(n){t[Event[e][2]](n,this)})},EventBind.prototype.render=function(t,e,n){this.node.loader._render(t,e,n)},EventBind.prototype._toggleActive=function(t){$(t.target).attr("active")||($(t.target).attr("active",!0).siblings().removeAttr("active"),target={},this.node.loader.element=$(t.target),this.node.loader._find())},EventBind.prototype._iconCopy=function(t){let e;const n=$(t.target),o=n.attr("value"),i=n.attr("type");if(i){const t=(e="next"===i?n.next("input, textarea"):n.prev("input, textarea")).prop("disabled");$(e).prop("disabled",!1).select(),document.execCommand("copy"),t&&$(e).prop("disabled",!0)}else{const t=$("<input style='top:-9999px;position:absolute;'>");$("body").append(t),o?t.val(o).select():n.hasClass("next")?t.val(n.next().html()).select():n.hasClass("prev")&&t.val(n.prev().html()).select(),document.execCommand("copy"),t.remove()}},EventBind.prototype._iconPaste=function(t){const e=$(t.target),n=e.attr("type");n&&("next"===n?e.next("input, textarea").select():e.prev("input, textarea").select(),document.execCommand("paste"))},EventBind.prototype._calendar=function(t){if(calendars===t.target)return!1;calendars=t.target,calendar&&calendar.destroy(),$(".pika-single").remove();const e=$(t.target).attr("date")||"Jan 01 1970",n=$(t.target).attr("minDate")||"Jan 01 1900";calendar=new Calendar({field:calendars,firstDay:1,position:"top right",defaultDate:new Date(e),minDate:new Date(n),maxDate:new Date,yearRange:[1900,2020],format:"DD-MM-YYYY",disableDayFn:!0})},EventBind.prototype._togglePassword=function(t){$(t.target).is(":disabled")?"mouseenter"===t.type?$(t.target).attr("type","text"):$(t.target).attr("type","password"):"focusin"===t.type?$(t.target).attr("type","text"):"focusout"===t.type&&$(t.target).attr("type","password")},EventBind.prototype._maxBuffer=function(t){const e=$(t.target),n=target,o=e.prop("name"),i=Buffer.byteLength(e.val());if(e.val()){let r=-1!==e.attr("name").indexOf("question")&&this.node.auth.hsm.length?this.node.auth.hsm.length:32;if(i>r){if(n[o]){if(-1!==$.inArray(t.keyCode,[8,9,13,27,46,109,111,189,191])||!(65!==t.keyCode&&67!==t.keyCode||!0!==t.ctrlKey&&!0!==t.metaKey))return;t.preventDefault()}else EventBind.tooltip(e,Langs.Credential.Auth.error.exceed_max_size,{toggleAnimation:5}),t.preventDefault();setTimeout(function(){e.val(Buffer.from(e.val()).toString("utf8",0,r))},1)}else n[o]&&i!==r&&n[o].stop().remove()}else n[o]&&n[o].stop().remove()},EventBind.prototype._maxSize=function(t){const e=$(t.target).attr("length")||32;$(t.target).prop("maxLength",e)},EventBind.prototype._isName=function(t){" "===$(t.target).val().substr(-1)&&32===t.keyCode&&t.preventDefault(),-1!==$.inArray(t.keyCode,[8,9,13,27,32,46,109,110,189])||65===t.keyCode&&(!0===t.ctrlKey||!0===t.metaKey)||t.keyCode>=35&&t.keyCode<=40||(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&(t.shiftKey||190!==t.keyCode)&&(t.keyCode<65||t.keyCode>90)&&t.preventDefault()},EventBind.prototype._digitdash=function(t){-1!==$.inArray(t.keyCode,[8,9,13,27,46,109,111,189,191])||65===t.keyCode&&(!0===t.ctrlKey||!0===t.metaKey)||t.keyCode>=35&&t.keyCode<=40||(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()},EventBind.prototype._fixedNumber=function(t){let e=t.keyCode||t.which;e>=96&&e<=105&&(e-=48);const n=$(t.target).val(),o=110===e||190===e?".":String.fromCharCode(e);-1!==$.inArray(e,[8,9,13,27,46,189])||65===e&&(!0===t.ctrlKey||!0===t.metaKey)||e>=35&&e<=40||(isNumeric(`${n}${o}`)&&32!==t.keyCode||t.preventDefault(),(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&110===t.keyCode&&190===t.keyCode&&t.preventDefault())},EventBind.prototype._insertSecret=function(t,e){let n=($(t.target).parent().parent().find("input").length-4)/2;const o=EventBind.emptyInput(`input:lt(${2*n+2})`);if(n+=1,o instanceof Array)for(let t in o)EventBind.tooltip(o[t],"*Required");else{let t=$("#wallet_secret").html();const o=$(e).prev();t=t.replace('name="question"',`name="question_${n}"`).replace('name="answer"',`name="question_${n}"`).replace(/\[count\]/g,n),o.parent().find("input:gt("+(2*(n-2)+1)+"):lt(2)").prop("disabled",!0),2==n?$(t).insertAfter(o).hide().slideDown(300):(o.find(".flaticon-remove").remove(),o.prev().find(".flaticon-remove").remove(),o.prev().prev().slideUp(300).prev().slideUp(300,function(){$(t).insertAfter(o).hide().slideDown(300)}),this.node.auth.getMaxLock()-2<n-1&&$(e).remove())}},EventBind.prototype._removeSecret=function(){$(".r_wallet_remove:lt(2)").parent().remove()},EventBind.prototype._checkAddress=function(t){checkAddress(t)},EventBind.prototype._checkPubKeyHashAddress=function(t){checkAddress(t,[2,130],"Non-Witness/Pubkeyhash Address")},EventBind.prototype._walletManageAddress=function(t){$('menubutton[page="menu-top_wallet"]').removeAttr("active").click(),setTimeout(function(){waitElement('menubutton[module="manage"]',function(t){$('menubutton[module="manage"]').click()})},1)},EventBind.prototype._checkAmount=function(t){const e=$(t.target),n=$(t.target).next(),o=e.siblings("p"),i=e.val();o.html("").removeClass("error"),highlightInput([e,n],0),"focusin"!==t.type&&(i?isNumeric(i)?highlightInput([e,n],1,0):(o.html("Invalid Amount").addClass("error"),highlightInput([e,n],1,1)):highlightInput([e,n],0),e.hasClass("h_swapcoin")&&swapCoin(e))},EventBind.prototype._copyAddress=async function(t){const e=$(t.target);clipboard.writeText(e.html());const n=await this.node.info.createReceive();e.html(n)},EventBind.prototype._addAddress=async function(t){const e=$(t.target),n=getSend(e);if(!n)return;let o=e.siblings("table");o.length||(e.after('<p></p><table><tr><th>Recipient Address</th><th>Value</th><th title="Delete">Del.</th></tr></table><p></p>'),o=e.parent().find("table").addClass("outputs")),o.append(`<tr><td title="Address: ${n.addr}">${n.addr}</td>`+`<td title="Value: ${n.val}">${n.val}</td><td><i class="glyph-icon flaticon-remove r_deleteAddress"></i></td></tr>`),e.parent().parent().find("input.address, input.h_swapcoin, input.h_swapcoin + a").each(function(){$(this).val(""),highlightInput($(this),0)})},EventBind.prototype._deleteAddress=async function(t){const e=$(t.target).parent().parent(),n=e.parent().parent();1===e.siblings().length?(n.siblings("p").remove(),n.remove()):e.remove()},EventBind.prototype._walletGetHistory=async function(t){const e=$(t.target),n=e.attr("offset"),o=e.attr("limit");e.parent().parent().html(await this.node.info.getWalletHistory(o,n))},EventBind.prototype._expSearch=async function(t){const e=$(t.target),n="click"==t.type?e.prev().val():e.val();if(13!=t.keyCode&&"INPUT"==t.target.nodeName||!n)return;const o=e.parent().parent().parent().parent();return this.expSearch(n,o)},EventBind.prototype._goExpHome=function(t){$('menubutton[page="menu-top_explorer"]').removeAttr("active").trigger("click")},EventBind.prototype._getExpAdressTransactions=async function(t){const e=$(t.target),n=e.attr("limit"),o=e.attr("offset"),i=await this.node.info.getExpAdressTransactions(n,o),r=e.parents("print");this.render(r,i,{category:"explorer",module:"address"})},EventBind.prototype._goToExp=function(t,e){this.node.info.isExpHome(!1),$('menubutton[page="menu-top_explorer"]').removeAttr("active").trigger("click");const n=this;setTimeout(function(){n.node.info.isExpHome(!0),waitElement('bodycontain[category="explorer"]',function(e){const o=$(t.target).val()||$(t.target).attr("value")||$(t.target).html();return n.expSearch(o,e)})},1)},EventBind.prototype._genGotoAddress=async function(t){const e=$(t.target),n=e.html(),o=e.parent().parent().parent().parent().parent().parent().children("print"),i=await this.node.info.setGenSearchAddress(n);this.render(o,i,{category:"address",module:"list"})},EventBind.prototype._genGotoAddresses=async function(t){const e=$(t.target),n=e.attr("limit"),o=e.attr("offset"),i=await this.node.info.getGenAddress(n,o),r=$("addressprint print");this.render(r,i,{category:"address",module:"list"})},EventBind.prototype._genSearchAddress=async function(t){const e=$(t.target),n="click"==t.type?e.prev().val():e.val();if(13!=t.keyCode&&"INPUT"==t.target.nodeName||!n)return;const o=e.parent().parent().next(),i=await this.node.info.setGenSearchAddress(n);this.render(o,i,{category:"address",module:"list"})},EventBind.prototype._menuLogout=async function(t){location.reload()},EventBind.emptyInput=function(t){let e=[],n=0;return $(t).each(function(){n++,$(this).val()||e.push($(this))}),e.length?e:n},EventBind.tooltip=function(t,e,n={}){let o={},i=target;const r=t.prop("name");let s=$(`<tooltip>${e}</tooltip>`);$(t).after(s);let a=$(t).offset().left,l=$(t).offset().top;"right"==n.position?l-=$(t).outerHeight():"top"==n.position?(l-=$(t).outerHeight(),a=a+$(t).outerWidth()-$(s).outerWidth()):(a=a+$(t).outerWidth()+10,l=l+$(t).outerHeight()/2-$(s).outerHeight()/2),o.left=a,o.top=l,s.css(o),n.toggleAnimation&&(i[r]?$(t).on("keyup paste change",function(){s.remove()}):(i[r]=s,i[r].show(0).delay(1e3*n.toggleAnimation).hide(0,function(){delete i[r],$(this).remove()})))},EventBind.modalBox=function(t,e,n={}){const o=`<modalbox><div><span${n.type?' class="'+n.type+'"':""}>${n.title?n.title:""}</span>\n    <i class="glyph-icon flaticon-remove"></i></div><div>${e}</div></modalbox>`,i=$(t).prepend(o);return n.transformZ&&$(t).css("-webkit-transform","translateZ(0)"),i},EventBind.add=function(t,e,n){$(document).on(t,e,n)},EventBind.prototype.expSearch=async function(t,e){const{module:n,data:o}=await this.getExpData(t),i=e.find('menuhidden[category="explorer"]');for(let t of i)$(t).attr("module")===n&&$(t).removeAttr("active").trigger("click");return o||e.find('menuhidden[module="404"]').trigger("click"),o},EventBind.prototype.getExpData=async function(t){if(this.node.info.resetExplorer(),isNumeric(t)){const e=await this.node.info.setExpBlockByHeight(t);return!1!==e&&{module:"block",data:e}}if(64===t.length){const e=await this.node.info.setExpBlockByHash(t);if(!1!==e)return{module:"block",data:e};const n=await this.node.info.setExpTransaction(t);if(!1!==n)return{module:"transaction",data:n};const o=await this.node.info.setExpPending(t);if(!1!==o)return{module:"pending",data:o}}const e=await this.node.info.setExpAddress(t);return!1!==e&&{module:"address",data:e}},module.exports=EventBind},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);this.alg=o.alg.PBKDF2,this.hash=o.hashByVal[1],this.iter=1e4,this.salt=Buffer.alloc(0),this.r=0,this.p=0,this.length=32,this.locker=new a,t&&this.fromOptions(t)}function i(t,e){return t.charCodeAt(Math.floor(e%t.length))}const r=n(1),s=Core.utils.util,a=Core.utils.Lock,l=Core.crypto.cleanse,c=Core.crypto.pbkdf2,p=Core.crypto.scrypt,h=Core.crypto.digest;o.alg={PBKDF2:0,SCRYPT:1},o.algByVal={0:"PBKDF2",1:"SCRYPT"},o.hash={SHA256:0,SHA512:1},o.hashByVal={0:"SHA256",1:"SHA512"},o.prototype.fromOptions=function(t){return r(t),null!=t.alg&&("string"==typeof t.alg?(this.alg=o.alg[t.alg.toUpperCase()],r(null!=this.alg,"Unknown algorithm.")):(r("number"==typeof t.alg),r(o.algByVal[t.alg]),this.alg=t.alg)),null!=t.hash&&("string"==typeof t.hash?(r(null!=o.hash[t.hash.toUpperCase()],"Unknown hash."),this.hash=o.hashByVal[o.hash[t.hash.toUpperCase()]]):(r("number"==typeof t.hash),r(o.hashByVal[t.hash]),this.hash=o.hashByVal[t.hash])),null!=t.iter&&(r(s.isU32(t.iter)),this.iter=t.iter),null!=t.r&&(r(s.isU32(t.r)),this.r=t.r),null!=t.p&&(r(s.isU32(t.p)),this.p=t.p),null!=t.length&&(r(s.isU32(t.length)),this.length=t.length),this},o.prototype.encrypt=async function(t,e,n){const o=await this.locker.lock();try{return await this._encrypt(t,e,n)}finally{o()}},o.prototype._encrypt=async function(t,e,n){if(!t&&!e&&!n)throw new Error("WalletID, DOB and Secret are required.");r(n instanceof Array);for(let t=0;t<n.length;t++)r(n[t]instanceof Object);return this.hashlock=await this.derive(t,e),this.secret(n)},o.prototype.decrypt=async function(t,e,n){const o=await this.locker.lock();try{return await this._decrypt(t,e,n)}finally{o()}},o.prototype._decrypt=async function(t,e,n){if(!t&&!e&&!n)throw new Error("WalletID, DOB and Lock are required.");if(s.isHex(n)){const t=new RegExp(`.{1,${2*this.length+2}}`,"g"),e=n.match(t);n=[];for(let t=0;t<e.length;t++)n[t]=Buffer.from(e[t],"hex")}else if(Buffer.isBuffer(n)){const t=n,e=this.length+1;n=[];for(let o=0;o<t.length/e;o++)n[o]=t.slice(o*e,o*e+e)}for(let t=0;t<n.length;t++)r(n[t].length===this.length+1);return r(n instanceof Array),this.hashlock=await this.derive(t,e),this.answers=Buffer.alloc(0),this.locks=n.slice(0),this.salt=Buffer.from(e,"utf8"),await this.question()},o.prototype.destroy=async function(){const t=await this.locker.lock();try{return await this._destroy()}finally{t()}},o.prototype._destroy=function(){this.hashlock&&(l(this.hashlock),this.hashlock=null),this.answers&&(this.answers=null),this.locks&&(l(this.locks),this.locks=null)},o.prototype.secret=function(t){if(!this.hashlock)return null;let e={},n=Buffer.alloc(0),o=Buffer.alloc(0);e.locks=[];for(let i=0;i<t.length;i++)e.locks[i]=this.lock(Buffer.from(t[i].question)),o=h.sha256(Buffer.from(t[i].answer)),n=h.sha256(Buffer.concat([n,o]));return e.passphrase=this.passphrase(n),e},o.prototype.lock=function(t){if(!this.hashlock)return null;let e;(e=Buffer.alloc(function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}(t.length,this.length),0)).write(t.toString().replace(/\0/g,""),0);const n=this.hashlock.toString("ascii"),o=Buffer.from(e).toString("ascii"),r=Buffer.from(Array.prototype.map.call(n,function(t,e){return t.charCodeAt(0)^i(o,e)}));return Buffer.concat([Buffer.from([e.length]),r])},o.prototype.passphrase=function(t){if(r(Buffer.isBuffer(t)),!this.hashlock)return null;const e=h.sha256(this.hashlock).toString("ascii"),n=h.sha256(t).toString("ascii");return Buffer.from(Array.prototype.map.call(e,function(t,e){return t.charCodeAt(0)^i(n,e)}))},o.prototype.question=async function(){if(!this.hashlock)return null;let t={};if(this.locks.length){const e=this.hashlock.toString("ascii"),n=this.locks[0].slice(1,this.locks[0][0]+1);this.locks.shift(),t.question=Buffer.from(Array.prototype.map.call(n,function(t,n){return String.fromCharCode(t^i(e,n))}).join("").replace(/\0/g,""))}else t.passphrase=this.passphrase(this.answers);return t},o.prototype.setAnswer=function(t){const e=h.sha256(Buffer.from(t)),n=this.answers?Buffer.concat([this.answers,e]):e;return this.answers=h.sha256(n),this.question()},o.prototype.derive=async function(t,e){const n=this.iter,i=this.hash,r=this.r,s=this.p;if("string"==typeof t){Buffer.alloc(this.length,0).write(t.replace(/\0/g,""),0)}switch(Buffer.isBuffer(e)||(e=Buffer.from(e,"utf8")),this.alg){case o.alg.PBKDF2:return await c.deriveAsync(t,e,n,this.length,i);case o.alg.SCRYPT:return await p.deriveAsync(t,e,n,r,s,this.length);default:throw new Error(`Unknown algorithm: ${this.alg}.`)}},o.toObject=function(t){let e;return Array.isArray(t.locks)?e=s.concatArrBuf(t.locks):"string"==typeof t.locks?(r(s.isHex(t.locks)),e=Buffer.from(t.locks,"hex")):e=t.locks,r(Buffer.isBuffer(e)),r(Buffer.isBuffer(t.passphrase)),{lock:e,chksum:t.passphrase.slice(0,4)}},t.exports=o},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);this.level=o.levels.NONE,this.colors=o.HAS_TTY,this.console=!0,this.browser=!0,this.shrink=!0,this.closed=!0,this.closing=!1,this.filename=null,this.stream=null,this.contexts=Object.create(null),this.locker=new p,t&&this.set(t)}function i(t,e){if(!(this instanceof i))return new i(t,e);s("string"==typeof e),this.logger=t,this.module=e}function r(t){return new Promise((e,n)=>{const o=a.createWriteStream(t,{flags:"a"}),i=()=>{o.removeListener("error",r),o.removeListener("open",s)},r=t=>{try{o.close()}catch(t){}i(),n(t)},s=()=>{i(),e(o)};o.once("error",r),o.once("open",s)})}const s=n(1),a=Core.utils.fs,l=Core.utils.util,c=Core.utils.co,p=Core.utils.Lock;o.HAS_TTY=Boolean(process.stdout&&process.stdout.isTTY),o.MAX_FILE_SIZE=20<<20,o.levels={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4,SPAM:5},o.levelsByVal=["none","error","warning","info","debug","spam"],o.prefixByVal=["N","E","W","I","D","S"],o.styles=["0","1;31","1;33","94","90","90"],o.prototype.set=function(t){s(t),s(this.closed),"string"!=typeof t?(null!=t.level&&(s("string"==typeof t.level),this.setLevel(t.level)),null!=t.colors&&o.HAS_TTY&&(s("boolean"==typeof t.colors),this.colors=t.colors),null!=t.console&&(s("boolean"==typeof t.console),this.console=t.console),null!=t.browser&&(s("boolean"==typeof t.browser),this.browser=t.browser),null!=t.shrink&&(s("boolean"==typeof t.shrink),this.shrink=t.shrink),null!=t.filename&&(s("string"==typeof t.filename,"Bad file."),this.filename=t.filename)):this.setLevel(t)},o.prototype.open=async function(){const t=await this.locker.lock();try{return await this._open()}finally{t()}},o.prototype._open=async function(){this.filename?this.stream?this.closed=!1:a.unsupported?this.closed=!1:(this.shrink&&await this.truncate(),this.stream=await r(this.filename),this.stream.once("error",this.handleError.bind(this)),this.closed=!1):this.closed=!1},o.prototype.close=async function(){const t=await this.locker.lock();try{return await this._close()}finally{t()}},o.prototype._close=async function(){if(null!=this.timer&&(c.clearTimeout(this.timer),this.timer=null),a.unsupported)return this.closed=!0,void(this.stream=null);if(this.stream){try{this.closing=!0,await function(t){return new Promise((e,n)=>{const o=()=>{t.removeListener("error",i),t.removeListener("close",r)},i=t=>{o(),n(t)},r=()=>{o(),e(t)};t.removeAllListeners("error"),t.removeAllListeners("close"),t.once("error",i),t.once("close",r),t.close()})}(this.stream)}finally{this.closing=!1}this.stream=null}this.closed=!0},o.prototype.truncate=async function(){if(!this.filename)return;if(a.unsupported)return;s(!this.stream);let t;try{t=await a.stat(this.filename)}catch(t){if("ENOENT"===t.code)return;throw t}const e=o.MAX_FILE_SIZE;if(t.size<=e+e/10)return;this.debug("Truncating log file to %d bytes.",e);const n=await a.open(this.filename,"r+"),i=Buffer.allocUnsafe(e);await a.read(n,i,0,e,t.size-e),await a.ftruncate(n,e),await a.write(n,i,0,e,0),await a.close(n)},o.prototype.handleError=function(t){try{this.stream.close()}catch(t){}this.stream=null,this.retry()},o.prototype.reopen=async function(){const t=await this.locker.lock();try{return await this._reopen()}finally{t()}},o.prototype._reopen=async function(){if(!this.stream&&!this.closed&&!a.unsupported){try{this.stream=await r(this.filename)}catch(t){return void this.retry()}this.stream.once("error",this.handleError.bind(this))}},o.prototype.retry=function(){s(null==this.timer),this.timer=c.setTimeout(()=>{this.timer=null,this.reopen()},1e4,this)},o.prototype.setFile=function(t){s("string"==typeof t),s(!this.stream,"Log stream has already been created."),this.filename=t},o.prototype.setLevel=function(t){const e=o.levels[t.toUpperCase()];s(null!=e,"Invalid log level."),this.level=e},o.prototype.error=function(...t){if(this.level<o.levels.ERROR)return;const e=t[0];e instanceof Error?this.logError(o.levels.ERROR,null,e):this.log(o.levels.ERROR,null,t)},o.prototype.warning=function(...t){if(this.level<o.levels.WARNING)return;const e=t[0];e instanceof Error?this.logError(o.levels.WARNING,null,e):this.log(o.levels.WARNING,null,t)},o.prototype.info=function(...t){if(this.level<o.levels.INFO)return;const e=t[0];e instanceof Error?this.logError(o.levels.INFO,null,e):this.log(o.levels.INFO,null,t)},o.prototype.debug=function(...t){if(this.level<o.levels.DEBUG)return;const e=t[0];e instanceof Error?this.logError(o.levels.DEBUG,null,e):this.log(o.levels.DEBUG,null,t)},o.prototype.spam=function(...t){if(this.level<o.levels.SPAM)return;const e=t[0];e instanceof Error?this.logError(o.levels.SPAM,null,e):this.log(o.levels.SPAM,null,t)},o.prototype.log=function(t,e,n){this.closed||this.level<t||(this.writeConsole(t,e,n),this.writeBrowser(t,e,n),this.writeStream(t,e,n))},o.prototype.context=function(t){let e=this.contexts[t];return e||(e=new i(this,t),this.contexts[t]=e),e},o.prototype.writeConsole=function(t,e,n){const i=o.levelsByVal[t];if(s(i,"Invalid log level."),!this.console)return!1;if(!process.stdout){let r=`[${i}] `;return e&&(r+=`(${e}) `),"object"==typeof n[0]?t===o.levels.ERROR?console.error(r,n[0]):console.log(r,n[0]):(r+=l.format(n,!1),t===o.levels.ERROR?(console.error(r),!0):(console.log(r),!0))}let r;if(this.colors){const e=o.styles[t];s(e),r=`[${e}m[${i}][m `}else r=`[${i}] `;return e&&(r+=`(${e}) `),r+=l.format(n,this.colors),r+="\n",t===o.levels.ERROR?process.stderr.write(r):process.stdout.write(r)},o.prototype.writeBrowser=function(t,e,n){const i=o.levelsByVal[t];if(s(i,"Invalid log level."),!this.browser)return!1;let r=`[${i}] `;return e&&(r+=`(${e}) `),"object"==typeof n[0]?t===o.levels.ERROR?console.error(r,n[0]):console.log(r,n[0]):(r+=l.format(n,!1),t===o.levels.ERROR?(console.error(r),!0):("net"!==e&&console.log(r),!0))},o.prototype.writeStream=function(t,e,n){const i=o.prefixByVal[t];if(s(i,"Invalid log level."),!this.stream)return;if(this.closing)return;let r=`[${i}:${l.date()}] `;e&&(r+=`(${e}) `),r+=l.format(n,!1),r+="\n",this.stream.write(r)},o.prototype.logError=function(t,e,n){if(this.closed)return;a.unsupported&&this.console&&t<=o.levels.WARNING&&console.error(n);let i=String(n.message).replace(/^ *Error: */,"");t!==o.levels.ERROR&&(i=`Error: ${i}`),this.log(t,e,[i]),t<=o.levels.WARNING&&this.stream&&this.stream.write(n.stack+"\n")},o.prototype.memory=function(t){const e=l.memoryUsage();this.log(o.levels.DEBUG,t,["Memory: rss=%dmb, js-heap=%d/%dmb native-heap=%dmb",e.total,e.jsHeap,e.jsHeapTotal,e.nativeHeap])},i.prototype.open=function(){return this.logger.open()},i.prototype.close=function(){return this.logger.close()},i.prototype.setFile=function(t){this.logger.setFile(t)},i.prototype.setLevel=function(t){this.logger.setLevel(t)},i.prototype.error=function(...t){if(this.logger.level<o.levels.ERROR)return;const e=t[0];e instanceof Error?this.logError(o.levels.ERROR,e):this.log(o.levels.ERROR,t)},i.prototype.warning=function(...t){if(this.logger.level<o.levels.WARNING)return;const e=t[0];e instanceof Error?this.logError(o.levels.WARNING,e):this.log(o.levels.WARNING,t)},i.prototype.info=function(...t){if(this.logger.level<o.levels.INFO)return;const e=t[0];e instanceof Error?this.logError(o.levels.INFO,e):this.log(o.levels.INFO,t)},i.prototype.debug=function(...t){if(this.logger.level<o.levels.DEBUG)return;const e=t[0];e instanceof Error?this.logError(o.levels.DEBUG,e):this.log(o.levels.DEBUG,t)},i.prototype.spam=function(...t){if(this.logger.level<o.levels.SPAM)return;const e=t[0];e instanceof Error?this.logError(o.levels.SPAM,e):this.log(o.levels.SPAM,t)},i.prototype.log=function(t,e){this.logger.log(t,this.module,e)},i.prototype.context=function(t){return new i(this.logger,t)},i.prototype.logError=function(t,e){this.logger.logError(t,this.module,e)},i.prototype.memory=function(){this.logger.memory(this.module)},o.global=new o,t.exports=o},function(t,e,n){"use strict";function o(){if(!(this instanceof o))return new o;this.files=[],this.root=r.join(__dirname,"../../"),this.init()}n(6);const i=n(5),r=n(0);o.prototype.init=function(){const t=i.readdirSync(this.root).filter(t=>".temp"===r.extname(t));this.install(t)},o.prototype.install=function(t){for(let e of t){const t=r.join(this.root,r.basename(e,".temp")),n=r.join(this.root,e);i.unlink(t,e=>{i.rename(n,t,t=>{})})}},t.exports=o},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);this.node=t,this.wallet=null,this.htm=null,this.decrypt=null,this.count=0,this._tempdb=null,this.init()}function i(t){const e=c.emptyInput(t);if(!(e instanceof Array))return!0;for(let t in e)c.tooltip(e[t],"*Required");return!1}function r(t,e){if(h.isName($(t).val()))return!0;const n=$(e).parent().parent(),o=`<span>${w.Credential.Auth.error.invalid_name.text_1}<br>${w.Credential.Auth.error.invalid_name.text_2}\n    <br>${w.Credential.Auth.error.invalid_name.text_3}</span><a class="button" cancel>${w.Auth.Button.try_again}</a>`,i=c.modalBox(n,o,{transformZ:!0,title:w.Credential.Auth.error.invalid_name.title});$("a[cancel], i").unbind("click").on("click",function(){$(i).css("-webkit-transform",""),$("modalbox").remove()})}function s(t,e){try{return u.wmcoin(t)}catch(t){const n=c.modalBox(e,'<span>Too many decimal point for amount.</span><a class="button" cancel>Try Again</a>',{transformZ:!0,title:"Invalid Amount"});return $("a[cancel], i").unbind("click").on("click",function(){$(n).css("-webkit-transform",""),$("modalbox").remove()}),!1}}n(1);const a=n(14),l=n(0),c=n(9),p=n(10),h=Core.common,u=(Core.primitives.Address,Core.wmcc.Amount),d=Core.protocol.policy,{dialog:f}=n(3).remote,g=(Core.crypto.digest,Core.crypto.secp256k1,Core.crypto.ccmp,n(8)),m=n(22),y=n(23),w=n(2),b=n(16);window.addEventListener("unhandledrejection",function(t,e){console.error(t.reason.stack)});const v=[["click",".s_wallet_create","_createWallet"],["click",".s_wallet_login","_loginWallet"],["click",".s_wallet_reset","_resetWallet"],["click",".s_secret_reset","_resetSecret"],["click",".s_createTx","_createTx"],["click",".s_requestTx","_requestTx"],["click",".s_resetSendCoin","_resetSendCoin"],["click",".s_signMessage","_signMessage"],["click",".s_verifyMessage","_verifyMessage"],["click",".s_wallet_getotp","_wallet_getotp"],["click",".s_wallet_changesecret","_wallet_changesecret"],["click",".s_wallet_updatesecret","_wallet_updatesecret"],["click",".s_backupWallet","_backupWallet"],["click",".s_restoreWallet","_restoreWallet"],["dragover dragleave dragenter drop",".s_dragdropWallet","_dragdropWallet"],["keypress","body","_enterPress"],["keyup","body","_escapePress"],["click",".s_configSave","_configSave"],["click",".s_stratumRemoveWorker","_stratumRemoveWorker"],["click",".s_stratumAddWorker","_stratumAddWorker"]];o.prototype.init=function(){const t=this;for(let e in v)$(document).on(v[e][0],v[e][1],function(n){t[v[e][2]](n)})},o.prototype._createWallet=async function(t){const e=$(t.target);e.prop("disabled",!0);i('input[name="name"], input[name="dob"], input[name*="question_"], input[name*="answer_"]')&&r('input[name="name"]',e)&&await this.createWallet(e),e.prop("disabled",!1)},o.prototype._loginWallet=async function(t){const e=$(t.target);e.prop("disabled",!0);const n=$('input[name="answer"');if(!i(`select[name="name"], input[name="dob"]${n.length?', input[name="answer"]':""}`))return e.prop("disabled",!1),!1;n.length?await this.processAnswer(e):await this.loadWallet(),e.prop("disabled",!1)},o.prototype._resetWallet=function(t){const e=t.target?$(t.target):$(t);(e.closest("h1 + holder").length?e.closest("h1 + holder"):e.closest("menu + content")).prev().find('tabbutton[active="true"], menubutton[active="true"]').removeAttr("active").trigger("click")},o.prototype._resetSecret=function(t){this._resetWallet(t)},o.prototype._createTx=async function(t){let e=[];const n=$(t.target).parent().parent(),o=n.find("table.outputs"),i=n.find(".address:first"),r=n.find('input[coin="wmcc"]');let a;if(i.val()&&r.val()&&!i.hasClass("error")&&!r.hasClass("error")){if(!(a=s(r.val().toString(),n)))return;e.push({value:a,address:i.val()})}if(o&&$("tr:not(:first-child)",o).each(function(){const t=$(this).children("td:first").html(),o=$(this).children("td:nth-child(2)").html();(a=s(o,n))&&e.push({value:a,address:t})}),!e.length)return;e=function(t){return[...t.reduce((t,e)=>{let n=t.get(e.address)||0;return t.set(e.address,e.value+n),t},new Map)].map(([t,e])=>({address:t,value:e}))}(e);const l=n.find('input[coin="rate"]');let p;try{p=u.wmcoin(l.val())}catch(t){return l.addClass("error"),void l.next().next().next().html("Too many decimal places.")}const h={outputs:e,rate:p};try{const n=await this.wallet.createTX(h);if(await this.wallet.sign(n,this.decrypt.passphrase.toString("hex")),!n.isSigned())throw new Error("TX could not be fully signed.");const o=n.toTX();if(o.getSigopsCost(n.view)>d.MAX_TX_SIGOPS_COST)throw new Error("TX exceeds policy sigops.");if(o.getWeight()>d.MAX_TX_WEIGHT)throw new Error("TX exceeds policy weight.");const i=e.length>1?Object.values(e).reduce((t,e)=>({value:t.value+e.value})):e[0],r=o.getFee(n.view),s=i.value+r,a=o.getRate(n.view);if(o.getMinFee()>r)throw new Error(`Fee below minimum value. <br>Minimum: ${u.wmcc(o.getMinFee())} wmcc, but got ${u.wmcc(r)} wmcc`);const l=`<span class="tx-details">${`\n      <table>\n        <tr><th colspan="2">Transaction Summary</th></tr>\n        <tr><td>Transaction Id</td><td long title="${o.txid()}"><a>: ${o.txid()}</a></td></tr>\n        <tr><td>Inputs Count</td><td>: ${o.inputs.length}</td></tr>\n        <tr><td>Outputs Count</td><td>: ${o.outputs.length}</td></tr>\n        <tr><td>Transaction Amount</td><td>: ${u.wmcc(i.value)} wmcc</td></tr>\n        <tr><td>Transaction Fee</td><td>: ${u.wmcc(r)} wmcc</td></tr>\n        <tr><td>Transaction Rate</td><td>: ${u.wmcc(a)} wmcc/kb</td></tr>\n        <tr><td>Net Amount</td><td>: ${u.wmcc(s)} wmcc</td></tr>\n      </table>\n    `}<i class="glyph-icon flaticon-otp"></i>\n      <input type="text" name="otp" class="r_fixedNumber" maxlength="6" placeholder="One Time Password (OTP)"><result></result>\n      <a class="button" confirm>Confirm</a></span>`,p=c.modalBox("leftcontain",l,{transformZ:!0,title:"Transaction Confirmation",type:"confirm"});$("i.flaticon-remove").unbind("click").on("click",function(){$(p).css("-webkit-transform",""),$("modalbox").remove()});const f=this;$("a[confirm]").unbind("click").on("click",async function(t){const e=$(t.target).prev(),n=$(t.target).prev().prev().val();if(!n)return e.html('<span class="error">Error: OTP is required.</span>');if(!f.node.auth.getPassphrase(n))return e.html(`<span class="error">Error: Invalid OTP, number of tried (${f.node.auth.otp.retry} of ${f.node.auth.otp.maxtry})</span>`);$(t.target).remove(),await f.wallet.db.addTX(o),f.wallet.logger.debug("Sending wallet tx (%s): %s",f.wallet.id,o.txid()),await f.wallet.db.send(o);const{otp:i}=f.node.auth.getPassphrase(n,!0);return e.html(`<span>Transaction Sent! Your new OTP: ${i} <i class="glyph-icon flaticon-copy s_resetSendCoin" value="${i}" title="Copy to clipboard"></i>\n        <i class="glyph-icon flaticon-continue s_resetSendCoin s_enterPress" value="${i}" title="Continue without copy"></i></span>`)})}catch(t){const e=`<span>${t.message}</span><a class="button" cancel>Try Again</a>`,n=c.modalBox("leftcontain",e,{transformZ:!0,title:t.type||"TransactionError"});$("a[cancel], i").unbind("click").on("click",function(){$(n).css("-webkit-transform",""),$("modalbox").remove()})}},o.prototype._requestTx=async function(t){const e=$(t.target),n="I"===e.prop("tagName")?e.parent().parent().parent():e.parent().parent(),o=(n.find('input[coin="wmcc"]').val(),n.find("textarea").val(),c.modalBox(n,'<span>Request payment via URI will be available <br>on next major update.</span><a class="button" cancel>Close</a>',{transformZ:!0,title:"Not Available"}));$("a[cancel], i").unbind("click").on("click",function(){$(o).css("-webkit-transform",""),$("modalbox").remove()})},o.prototype._resetSendCoin=function(){$('menubutton[page="menu-top_send-receive-coin"]').removeAttr("active").trigger("click")},o.prototype._signMessage=async function(t){const e=$(t.target).parent().parent(),n=e.find(".address").eq(0).val(),o=e.find(".message").eq(0).val(),i=e.find(".otp").eq(0).val(),r=e.find(".signature").eq(0),s=e.find("result").eq(0);if(s.html(""),r.val(""),e.find(".address").eq(0).hasClass("error"))return;if(!n||!o||!i)return s.html('<span class="error">Error: Address, Message and OTP are required.</span>');const a=this.node.auth.getPassphrase(i);if(!a)return s.html(`<span class="error">Error: Invalid OTP, number of tried (${this.node.auth.otp.retry} of ${this.node.auth.otp.maxtry})</span>`);try{const e=await this.wallet.getPrivateKey(n,a.toString("hex"));if(!e)return s.html('<span class="error">Error: Address is not owned by this wallet.</span>');const l=y.sign(o,e.getPrivateKey(),!0),{otp:c}=this.node.auth.getPassphrase(i,!0);return r.val(l.toString("base64")),s.html(`<span>Your new OTP: ${c} <i class="glyph-icon flaticon-copy" value="${c}" title="Copy to clipboard"></i></span>`)}catch(t){return s.html(`<span class="error">${t}</span>`)}},o.prototype._verifyMessage=function(t){const e=$(t.target).parent().parent(),n=e.find(".address").eq(0).val(),o=e.find(".message").eq(0).val(),i=e.find(".signature").eq(0).val(),r=e.find("result").eq(0);if(r.html(""),!n||!o||!i)return r.html('<span class="error">Error: Address, Message and Signature are required.</span>');try{return y.verify(o,n,i)?r.html("<span>The signature is valid for the address and message.</span>"):r.html('<span class="error">Message failed to verify!</span>')}catch(t){return r.html(`<span class="error">${t}</span>`)}},o.prototype._wallet_getotp=function(t){const e=$(t.target),n=e.parent(),o=n.find('[name="otp"]').eq(0).val(),i=n.find("result").eq(0);if(!o)return;const{passphrase:r,otp:s}=this.node.auth.getPassphrase(o,!0);return r?(e.remove(),i.html(`<span>Your new OTP: ${s} <i class="glyph-icon flaticon-copy s_wallet_changesecret" value="${s}" title="Copy to clipboard"></i>\n    <i class="glyph-icon flaticon-continue s_wallet_changesecret s_enterPress" value="${s}" title="Continue without copy"></i></span>`)):i.html(`<span class="error">Error: Invalid OTP, number of tried (${this.node.auth.otp.retry} of ${this.node.auth.otp.maxtry})</span>`)},o.prototype._wallet_changesecret=function(t){const e=$(t.target).parent().parent().parent().parent(),n=e.find('[name="name"]').eq(0),o=e.find('[name="dob"]').eq(0),i=this.node.auth.hsm.salt.toString("utf8"),r=e.find("walletcontent");r.eq(0).prop("hidden",!0),r.eq(1).removeAttr("hidden"),n.val(this.wallet.id),o.val(i)},o.prototype._wallet_updatesecret=async function(t){const e=$(t.target),n=e.parent().parent().parent().find(".s_wallet_changesecret").eq(0).attr("value"),o=this.node.auth.getPassphrase(n);if(i('input[name="name"], input[name="dob"], input[name*="question_"], input[name*="answer_"]')&&r('input[name="name"]',e)){const t=$('input[name="name"]').val(),n=$('input[name="dob"]').val();let i=[],r={};$('input[name*="question_"], input[name*="answer_"]').each(function(t){t%2==0?r.question=$(this).val():(r.answer=$(this).val(),i.push(r),r={})});const s=await this.node.auth.hsm.encrypt(t,n,i),{lock:a,chksum:l}=p.toObject(s);this.wallet.lock=a,this.wallet.chksum=l,await this.wallet.setPassphrase(o.toString("hex"),s.passphrase.toString("hex")),await this.node.auth.hsm.destroy(),this.hsm={},this._resetWallet(e)}},o.prototype._backupWallet=function(t){const e=$(t.target).parent().parent(),n=e.find('input[type="password"]'),o=e.find('input[name="compress-level"]:checked').val();if(e.find("p").html(""),e.find("result").html(""),e.find(".error").removeClass("error"),n.eq(0).val()!==n.eq(1).val())return n.eq(1).addClass("error"),void n.eq(1).next().html("Password don't match!");const i=this;f.showOpenDialog({properties:["openDirectory"]},async function(t){if(!t)return;const r={input:i.node.walletdb.db.location,output:l.join(t[0],`DONT_RENAME_${i.node.walletdb.suffix}.bak`),level:o,password:n.eq(0).val()},s=new a(r),c=await s.compress();e.find("result").html(`<span>File saved to <a title="${c.path}">${c.path}</a></span>`)})},o.prototype._restoreWallet=function(t){const e=$(t.target).parent().parent().parent().parent(),n=this;f.showOpenDialog({properties:["openFile"]},async function(t){t&&n.restoreWallet(t[0],e)})},o.prototype._dragdropWallet=function(t){t.preventDefault(),t.stopPropagation();const e=$(t.target).closest("dragdrop"),n=e.parent().parent().parent();if("dragover"===t.type)e.css({"background-color":"#DDFFDD"});else if("dragleave"===t.type)e.css({"background-color":"#f9f9f9"});else if("drop"===t.type){const o=t.originalEvent.dataTransfer.files[0].path;this.restoreWallet(o,n),e.css({"background-color":"#f9f9f9"})}},o.prototype.restoreWallet=function(t,e){let n,o;const i=this.node.auth.wallets;try{o=l.parse(t).name.replace("DONT_RENAME_",""),n=this.node.auth.fromSuffix(o)}catch(t){const n=c.modalBox(e,'<span>Invalid wallet backup (.bak) file.</span><a class="button">Try Again</a>',{transformZ:!0,title:"Invalid File"});return void $("a.button, i").unbind("click").on("click",async function(){$(n).css("-webkit-transform",""),$("modalbox").remove()})}if(i.includes(n)){const i=`<span>Wallet <a>${n}</a> is already exists. Do you want to overwrite it?\n      <label>Warning: If you overwrite, all data in the existing wallet will be lost.</label>\n      </span><a class="button" overwrite>Overwrite</a><a class="button" cancel>Cancel</a>`,r=c.modalBox(e,i,{transformZ:!0,title:"Wallet Exists"}),s=this;$("a.button, i").unbind("click").on("click",function(){$(r).css("-webkit-transform",""),$("modalbox").remove(),this.hasAttribute("overwrite")&&s.renderZipPassword(t,o,e,n)})}else this.renderZipPassword(t,o,e,n)},o.prototype.renderZipPassword=function(t,e,n,o){const i=c.modalBox(n,'<span>Enter your password if the password was set:\n    <input type="password" />\n    </span><a class="button" next>Next</a>',{transformZ:!0,title:"Wallet .bak Password",type:"confirm"}),r=this;$("a.button, i").unbind("click").on("click",async function(){const s=$(this).prev().find("input").eq(0).val();if($(i).css("-webkit-transform",""),$("modalbox").remove(),this.hasAttribute("next")){const i={input:t,output:l.join(r.node.walletdb.options.location,`${e}.ldb`),password:s},p=new a(i);p.on("error",t=>{const e=`<span>${t.message}</span><a class="button">Try Again</a>`,o=c.modalBox(n,e,{transformZ:!0,title:t.type});$("a.button, i").unbind("click").on("click",async function(){$(o).css("-webkit-transform",""),$("modalbox").remove()})}),p.on("done",()=>{const t=`<span>Your wallet <a>${o}</a> account successfully restored!</span><a class="button">Ok</a>`,e=c.modalBox(n,t,{transformZ:!0,title:"Wallet Successfully Restored",type:"confirm"});$("a.button, i").unbind("click").on("click",async function(){$(e).css("-webkit-transform",""),$("modalbox").remove()})}),await p.decompress()}})},o.prototype.createWallet=async function(t){const e=$('input[name="name"]').val(),n=$('input[name="dob"]').val();let o=[],i={};if($('input[name*="question_"], input[name*="answer_"]').each(function(t){t%2==0?i.question=$(this).val():(i.answer=$(this).val(),o.push(i),i={})}),this.node.auth.wallets.includes(e)){const n=t.parent().parent(),o=`<span>${w.args(w.Credential.Auth.error.wallet_name_exists.text_1,[`<b style="font-size: 14px;">${e}</b>`])}<br>${w.Credential.Auth.error.wallet_name_exists.text_2}</span><a class="button" cancel>${w.Auth.Button.cancel}</a>`,i=c.modalBox(n,o,{transformZ:!0,title:w.Credential.Auth.error.wallet_name_exists.title});$("a[cancel], i").unbind("click").on("click",function(){$(i).css("-webkit-transform",""),$("modalbox").remove()})}else{const i=Core.walletdb(this.node.walletdb.options);await this.node.ensure(),await this.node.auth.saveWallet(i,this.node.chain,e,n,o),this._resetWallet(t[0])}},o.prototype.loadWallet=async function(){const t=$('select[name="name"]'),e=t.find("option:selected").val(),n=$('input[name="dob"]');this._tempdb=Core.walletdb(this.node.walletdb.options);const o=this.node.auth.toSuffix(e);this._tempdb.suffix(o),this._tempdb.loaded||(await this.node.ensure(),await this.node.auth.tempopen(this._tempdb,this.node.chain)),this.wallet=await this._tempdb.get(e),this.hsm=this.node.auth.hsm,this.decrypt=await this.hsm.decrypt(e,n.val(),this.wallet.lock),this.decrypt.question&&(this.count=1,this.renderHint(),t.attr("disabled","disabled"),n.attr("disabled","disabled")),await this.node.auth.tempclose(this._tempdb)},o.prototype.renderHint=function(){$("render").html(`<holder><i class="glyph-icon flaticon-hint"><counter>${this.count}</counter></i>\n    <input type="text" name="question" value="${this.decrypt.question.toString().replace(/"/g,"&quot;")}" disabled>\n    </holder><holder><i class="glyph-icon flaticon-answer"><counter>${this.count}</counter></i>\n    <input type="password" name="answer" placeholder="${w.Auth.Login.your_answer}"></holder>`),this.count++},o.prototype.processAnswer=async function(t){const e=$('input[name="answer"]').val();if(this.decrypt=await this.hsm.setAnswer(e),this.decrypt.question)return void this.renderHint();if(this.wallet.chksum.toString()===this.decrypt.passphrase.slice(0,4).toString()){const e=this.node.auth.getOTP(this.decrypt.passphrase);return this.node.auth.otp.enable?await this.renderOTP(e,t,this.wallet):await this.setupNode(this.wallet),void(0===this.node.miner.addresses.length&&this.node.miner.addAddress(this.wallet.getReceive("hex").toString()))}const n=t.parent(),o=`<span>${w.Credential.Auth.error.invalid_credential.text_1}<br>${w.Credential.Auth.error.invalid_credential.text_2}</span>\n    <a class="button">${w.Auth.Button.try_again}</a>`,i=c.modalBox(n,o,{transformZ:!0,title:w.Credential.Auth.error.invalid_credential.title}),r=$(i).find("modalbox").find("i, a"),s=this;for(let e=0;e<r.length;e++)$(r[e]).unbind("click").on("click",function(){$(i).css("-webkit-transform",""),s._resetWallet(t)})},o.prototype.renderOTP=async function(t,e,n){this.node.auth.logged&&$("body").prepend('<div id="fullmodal" style="height:100%;width:100%;background:rgba(0,0,0,0.3);position:absolute;z-index:1;"></div>');let o="<span><a>Click icon below to copy OTP to clipboard<br>or click Close to continue without copying them.</a><br>";o+=`<b>${t}</b><i class="glyph-icon flaticon-copy" title="Copy to clipboard" value="${t}"></i><br>`,o+='<note>** Please make sure to write down the OTP somewhere.</note><br><a class="button s_enterPress">Close</a></span>';const i=c.modalBox(e.parent(),o,{transformZ:!0,title:"One Time Password (OTP)",type:"confirm"}),r=$(i).find("modalbox").find("i, a.button");$(i).children().addClass("otp");const s=this;for(let t=0;t<r.length;t++)$(r[t]).unbind("click").on("click",async function(){await s.setupNode(n),$("body").find("#fullmodal").remove()})},o.prototype.setupNode=async function(t){this.node.info.wallet=t,await this.node.walletdb.unbind(),await this.node.close(),this.node.walletdb=this._tempdb;for(let t of this.node.http.mounts)t.ctx.walletdb=this.node.walletdb,t.handler.walletdb=this.node.walletdb;this.node.miner.address=this.node.miner.getAddress()||t.getAddress(),this.node.attach=new m(this.node),await this.node.ensure(),await this.node.open(),await this.hsm.destroy(),await this.node.connect(),this.node.auth.logged=!0,this.node.auth.load(),g.init(this.node),this.updater=new b,this.updater.start();try{await t.zap(t.account.name,d.MAX_TX_SIGOPS_COST)}catch(t){}this.node.startSync()},o.prototype._enterPress=function(t){13==t.keyCode&&$(".s_enterPress").addClass("active").delay(100).queue(function(){$(this).removeClass("active").click().dequeue()})},o.prototype._escapePress=function(t){27==t.keyCode&&$(".s_escapePress").click()},o.prototype._configSave=function(t){const e=$(t.target),n=e.parent(),o=this.node.config.getDefault();let i="# Wmcc configuration file (wmcc.conf)\n";for(let t of Object.keys(o)){i+=`\n#\n# ${t}\n#\n\n`;for(let e in o[t]){const r=o[t][e][0],s=o[t][e][1],a=n.find(`input[name="${e}"], checkbox[name="${e}"]`).eq(0);let l;i+=`${r}`===`${l="bool"===s?$(a).prop("checked"):$(a).val()}`?`# ${e}: ${l}\n`:`${e}: ${l}\n`}}this.node.config.write("wmcc.conf",i),$(e).prev().html("Updated! Please relogin / restart wallet to apply this configuration.").show()},o.prototype._stratumRemoveWorker=function(t){const e=$(t.target).parent().parent().find("td").eq(0).text();this.node.stratum.userdb.remove(e),this._resetWallet(t)},o.prototype._stratumAddWorker=function(t){const e=$(t.target).parent().parent(),n=e.find(".workername").val(),o=e.find(".workerpass").val();e.find("p").removeClass().html("").hide();try{this.node.stratum.userdb.add({username:n,password:o})}catch(t){return void e.find("p").eq(0).addClass("error").html(t.message).show()}this._resetWallet(t)},t.exports=o},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);s.call(this),this.options=new i(t),this.input=this.options.input,this.output=this.options.output,this.level=this.options.level,this.password=this.options.password,this.files=this.options.files,this.locker=new d}function i(t){if(!(this instanceof i))return new i(t);this.input=null,this.output=null,this.level=5,this.password=null,this.files=[],t&&this.fromOptions(t)}const r=n(1),s=n(31),a=n(15),l=n(32),c=n(5),p=n(0),{PassThrough:h}=n(33),u=Core.utils.encoding,d=Core.utils.Lock;Object.setPrototypeOf(o.prototype,s.prototype),o.prototype.addFiles=function(t){r(t instanceof Array);for(let e of t)this.addFile(e)},o.prototype.addFile=function(t){r("string"==typeof t),"LOCK"!==t&&(this.files.includes(t)||this.files.push(t))},o.prototype.removeFiles=function(t){r(t instanceof Array);for(let e of t)this.addFile(e)},o.prototype.remove=function(t){r("string"==typeof t),this.files=this.files.filter(e=>e!==t)},o.prototype.compress=async function(){const t=await this.locker.lock();try{return await this._compress()}finally{t()}},o.prototype._compress=async function(){const t=await this.readDir(this.input);t.length&&this.addFiles(t);const e=this.compile();return this.zip(e)},o.prototype.decompress=async function(){const t=await this.locker.lock();try{await this._decompress()}finally{t()}},o.prototype._decompress=async function(){const t=await this.readFile(this.input),e=this.unzip(t);this.mkdirp(this.output),this.readBuffer(e)},o.prototype.readBuffer=function(t){const e=this;let n=Buffer.alloc(0);t.on("error",function(t){e.emit("error",{type:"Wrong Password",message:"The password you have entered is incorrect. Please try again."})}).on("data",function(t){n=Buffer.concat([n,t])}).on("end",async function(){let t=1,o=0;const i=n.readInt16LE(t);try{for(let r=0;r<i;r++){t=0===r?3:o+t+4,o=n.readInt8(t);const s=n.slice(t+1,o+t+1);t=o+t+1,o=n.readInt32LE(t);const a=n.slice(t+4,o+t+4);await e.writeFile(s.toString("utf8"),a),r===i-1&&e.emit("done")}}catch(t){e.emit("error",{type:"File Corrupted",message:"The file is corrupted and cannot be opened."})}})},o.prototype.writeFile=function(t,e){const n=p.join(this.output,t);return new Promise(function(t,o){c.writeFile(n,e,e=>{e?o(e):t()})})},o.prototype.readDir=function(t){return new Promise(function(e,n){c.readdir(t,(t,o)=>{t?n(t):e(o)})})},o.prototype.readFile=function(t){return new Promise(function(e,n){c.readFile(t,(t,o)=>{t?n(t):e(o)})})},o.prototype.mkdirp=function(t,e){const n=p.dirname(t);c.existsSync(n)||this.mkdirp(n),c.existsSync(t)&&!e&&this.backup(t);try{c.mkdirSync(t)}catch(t){}},o.prototype.backup=async function(t){const e=this.output,n=this.input,o=t.split(p.sep),i=new Date(Date.now()).toISOString().replace(/:/g,"-");o[o.length-1]=i+"-"+o[o.length-1],o.splice(o.length-1,0,"backup");const r=p.join.apply(null,o);o.splice(o.length-1,1);const s=p.join.apply(null,o);this.mkdirp(s,!0),this.output=r,this.input=t,await this.compress(),this.output=e,this.input=n,this.mkdirp(t,!0)},o.prototype.unzip=function(t){const e=a.createDecipher("aes128",this.password),n=new h,o=l.createGunzip();return n.end(t),n.pipe(e).pipe(o)},o.prototype.compile=function(){const t=u.U8(1),e=u.U16(this.files.length);let n=Buffer.concat([t,e]);for(let t of this.files){const e=p.join(this.input,t),o=c.readFileSync(e),i=u.U32(o.length),r=Buffer.from(t,"utf8");n=Buffer.concat([n,Buffer.from([r.length]),r]),n=Buffer.concat([n,i,o])}return n},o.prototype.zip=function(t){r(t instanceof Buffer);const e=l.gzipSync(t,{level:this.level}),n=a.createCipher("aes128",this.password),o=c.createWriteStream(this.output),i=new h;return i.end(e),i.pipe(n).pipe(o)},i.prototype.fromOptions=function(t){if(null!=t.input&&(r("string"==typeof t.input),this.input=t.input),null!=t.output&&(r("string"==typeof t.output),this.output=t.output),null!=t.level&&("string"==typeof t.level&&(t.level=parseInt(t.level)),r("number"==typeof t.level),this.level=t.level),null!=t.password&&(r("string"==typeof t.password),this.password=t.password),null!=t.files)if(t.files instanceof Array)for(let e of t.files)r("string"==typeof e),this.files.includes(e)&&this.files.push(e);else r("string"==typeof t.files),this.files.push(t.files)},process.on("uncaughtException",function(t){}),t.exports=o},function(t,e){t.exports=require("crypto")},function(t,e,n){"use strict";function o(){if(!(this instanceof o))return new o;this.updater=s}function i(t,e){$(t).length?e($(t)):setTimeout(()=>{i(t,e)},1)}const{remote:r}=n(3),{autoUpdater:s}=r.require("electron-updater");o.prototype.start=function(){i("updatecontent",async t=>{this.updater.on("update-available",e=>{t.show(),t.addClass("progress"),t.html('<table><tr><td><span class="loading"><span class="progress_holder"><span class="progress_bar"></span>\n        <span id="prog_status">Downloading update: 0%</span></span></span></td></tr></table>')}),this.updater.on("update-not-available",e=>{t.show(),t.html("<h3>Your client application is up to date.</h3>"),setTimeout(()=>{t.hide()},8e3)}),this.updater.on("download-progress",e=>{t.show(),t.hasClass("progress")||(t.addClass("progress"),t.html('<table><tr><td><span class="loading"><span class="progress_holder"><span class="progress_bar"></span>\n          <span id="prog_status">Downloading update: 0%</span></span></span></td></tr></table>'));const n=`${e.percent.toFixed(2)}%`;$(".progress_bar").css("width",n),$("#prog_status").html(`Downloading update: ${n} | ${(e.bytesPerSecond/1e6).toFixed(3)} MB/SEC`)}),this.updater.on("update-downloaded",e=>{t.show(),t.removeClass("progress").addClass("completed"),t.html(`<table><tr><td><div>Update available! WMCC Client ${e.version}, you must restart this application to apply new update.</div></td>\n        <td><submit>Restart Now</submit></td><td></td><td><submit>Later</submit></td></tr></table>`);const n=t.find("submit");n.eq(0).click(()=>{this.updater.quitAndInstall(!0,!0)}),n.eq(1).click(()=>{t.hide()})}),this.updater.on("error",e=>{t.hide(),console.log(e)}),function(t,e){const n=Date.now();e.hide(),setInterval(t,432e5),"undefined"==typeof Storage?t():(!localStorage.WMCC_Update||localStorage.WMCC_Update<n-6e5)&&(localStorage.WMCC_Update=n,t())}(this.updater.checkForUpdatesAndNotify,t)})},t.exports=o},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);this.options=new i(t),this.network=this.options.network,this.logger=this.options.logger.context("authentication"),this.locker=new u,this.templocker=new u,this.hsm=new a({alg:this.options.alg,hash:this.options.hash,iter:this.options.iter,r:this.options.r,p:this.options.p,length:this.options.length}),this.otp=new l(this.options.otp),this.opened=!1,this.logged=!1,this.maxLock=10,this.wallets=[],this.load()}function i(t){if(!(this instanceof i))return new i(t);this.network=h.primary,this.logger=c.global,this.otp=!0,t&&this.fromOptions(t)}const r=n(15),s=n(1),a=n(10),l=n(18),c=n(11),p=Core.utils.fs,h=Core.protocol.Network,u=Core.utils.Lock;o.prototype.load=function(){this.logged?$("body").html("<menu><topmenu category='menu' module='top' tag='topmenu' active='true'></topmenu></menu><content></content>\n      <preload category='preload' module='preload' tag='preload' active='true'></preload>\n      <updater category='update' module='update' tag='updater' active='true'></updater>\n      <notification category='notification' module='main' tag='notification' active='true'></notification>"):$("body").html("<logo><img src='../image/head_logo.png'></logo><menu><tabs category='menu' module='auth' tag='tabs' active='true'></tabs></menu>\n      <content></content><preload category='preload' module='preload' tag='preload' active='true'></preload>\n      <copyright>WMCC Application &copy; World Mobile Coin</copyright>\n      \x3c!--<updater category='update' module='update' tag='updater' active='true'></updater>--\x3e")},o.prototype.open=async function(t,e){const n=await this.locker.lock();try{return await this._open(t,e)}finally{n()}},o.prototype._open=async function(t,e){s("object"==typeof t),s("object"==typeof e),e.loaded||await e.open(),await t.open(),this.opened=!0},o.prototype.tempopen=async function(t,e){const n=await this.templocker.lock();try{return await this._tempopen(t,e)}finally{n()}},o.prototype._tempopen=async function(t,e){s("object"==typeof t),s("object"==typeof e),e.loaded||await e.open();const n=t.bound;this.opened&&(t.bound=!0),await t.db.open(),t.bound=n,this.opened=!0},o.prototype.tempclose=async function(t,e){const n=await this.templocker.lock();try{return await this._tempclose(t,e)}finally{n()}},o.prototype._tempclose=async function(t,e){s("object"==typeof t),await t.db.close(),e&&(s("object"==typeof e),await e.close()),this.opened=!1},o.prototype.close=async function(t,e){const n=await this.locker.lock();try{return await this._close(t,e)}finally{n()}},o.prototype._close=async function(t,e){s("object"==typeof t),await t.close(),e&&(s("object"==typeof e),await e.close()),this.opened=!1},o.prototype.render=async function(t,e){const n=e.info.wallet?e.info.wallet.account.id:null,o=t.list(),i=[];if(o.length>0){for(let t of o){const e=t.split(".").shift();try{const t=this.fromSuffix(e);if(t===n)continue;i.push(t)}catch(t){}}i.sort();for(let t of i)$('select[name="name"]').append(`<option value="${t}">${t}</option>`),this.wallets=this.wallets.filter(e=>e!==t).concat([t])}this.wallets.length>0||$('menubutton[category="auth"][module="create"]').trigger("click")},o.prototype.saveWallet=async function(t,e,n,o,i){let r=await this.hsm.encrypt(n,o,i);const s=this.toSuffix(n);t.suffix(s),await this.ensure(t.db.db.location),await this.open(t,e),await t.set({id:n,hsm:r}),await this.hsm.destroy(),await this.close(t),r={}},o.prototype.ensure=function(t){return p.unsupported?Promise.resolve():p.mkdirp(t)},o.prototype.getOTP=function(t){return this.otp.encode(t)},o.prototype.getPassphrase=function(t,e){return this.otp.decode(t,e)},o.prototype.isOtpEnabled=function(){return this.otp.isEnabled()},o.prototype.getMaxLock=function(){return this.maxLock},o.prototype.toSuffix=function(t){const e=r.createCipher("aes128","wmcc-wallet");return`${e.update(t,"utf8","hex")}${e.final("hex")}`},o.prototype.fromSuffix=function(t){const e=r.createDecipher("aes128","wmcc-wallet");return`${e.update(t,"hex","utf8")}${e.final("utf8")}`},o.prototype.destroy=function(){this.opened=!1,this.logged=!1},i.prototype.fromOptions=function(t){null!=t.network&&(this.network=h.get(t.network)),null!=t.logger&&(s("object"==typeof t.logger),this.logger=t.logger),null!=t.otp&&(s("boolean"==typeof t.otp),this.otp=t.otp),null!=t.alg&&(s("string"==typeof t.alg||"number"==typeof t.alg),this.alg=t.alg),null!=t.hash&&(s("string"==typeof t.hash||"number"==typeof t.hash),this.hash=t.hash),null!=t.iter&&(s("number"==typeof t.iter),this.iter=t.iter),null!=t.r&&(s("number"==typeof t.r),this.r=t.r),null!=t.p&&(s("number"==typeof t.p),this.p=t.p),null!=t.length&&(s("number"==typeof t.length),this.length=t.length)},i.fromOptions=function(t){return(new i).fromOptions(t)},t.exports=o},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);this.enable=t,this.code=null,this.key=null,this.retry=0,this.maxtry=5}const i=n(1),r=n(15),s=n(24),a=Core.crypto.digest;o.prototype.encode=function(t){i(t,"Passphrase required.");const e=function(t,e){return Math.floor(Math.random()*(e-t+1))+t}(1e3,9999);this.code=r.randomBytes(16).toString("hex");const n=this._generateCode(e);return this.key=s.encrypt(t,n),e},o.prototype.decode=function(t,e){i(this.code,"OTP must be instantiate first");let n;const o=this._generateCode(t);try{n=Buffer.from(s.decrypt(this.key,o),"ascii")}catch(t){return this.retry++,this.retry>this.maxtry-1&&setTimeout(()=>{location.reload()},2e3),!1}if(this.retry=0,e){return{passphrase:n,otp:this.encode(n)}}return n},o.prototype._generateCode=function(t){i(t,"OTP required.");let e;for(let n=0;n<t;n++)0===n&&(e=this.code),e=a.sha256(Buffer.from(e)).toString("ascii");return e},o.prototype.isEnabled=function(){return this.enable},t.exports=o},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);c("string"==typeof t),c(t.length>0),this.module=t,this.network="mainnet",this.prefix=p.join(f,`.${t}`),this.options=Object.create(null),this.data=Object.create(null),this.env=Object.create(null),this.args=Object.create(null),this.argv=[],this.pass=[],this.query=Object.create(null),this.hash=Object.create(null)}function i(t){return Array.isArray(t)&&(t=t[0]),"number"==typeof t?`Argument #${t}`:t}function r(t){try{t=(t=decodeURIComponent(t)).replace(/\+/g," ")}catch(t){}return t=t.replace(/\0/g,"")}function s(t){return/^[a-z0-9]+$/.test(t)}function a(t){return/^[a-zA-Z0-9]+$/.test(t)}function l(t){return!!a(t)&&!/[A-Z]/.test(t)}const c=n(1),p=n(0),h=n(6),u=Core.utils.fs,d=Core.util,f=h.homedir?h.homedir():"/";o.alias={seed:"seeds",node:"nodes",n:"network"},o.default={Options:{network:["mainnet","str",!1]},Node:{prefix:["~/.wmcc","str",!0],db:["leveldb","str",!1],"max-files":["512","uint",!0],"cache-size":["100","mb",!0]},Logger:{"log-level":["error","str",!0],"log-file":["true","bool",!0]},Chain:{prune:["false","bool",!1],"index-tx":["true","bool",!1],"index-address":["true","bool",!1]},Mempool:{"mempool-size":["100","mb",!0],"persistent-mempool":["false","bool",!1]},Pool:{listen:["true","bool",!1],"max-outbound":["32","uint",!0],"max-inbound":["128","uint",!0]},"Localhost (to listen on)":{host:["::","str",!0],port:["8880","uint",!0]},"Public Host (to advertise to peers)":{"public-host":["127.0.0.1","str",!0],"public-port":["8880","uint",!0]},"HTTP / RPC":{"http-host":["::","str",!0],"http-port":["7880","uint",!0],"api-key":["","str",!0],"no-auth":["false","bool",!0]},"Stratum Host (to listen to miners)":{"stratum-host":["0.0.0.0","str",!0],"stratum-port":["6880","uint",!0],"stratum-public-host":["127.0.0.1","str",!0],"stratum-public-port":["6880","uint",!0],"stratum-max-inbound":["50","uint",!0],"stratum-notify-interval":["60","uint",!0],"stratum-difficulty":["1","uint",!0]},Miner:{"coinbase-flags":["mined by wmcc_user","str",!0,"r_maxsize"],"coinbase-address":["","str",!0,"r_checkAddress extrawidth"]},Wallet:{"wallet-witness":["true","bool",!0]}},o.prototype.getDefault=function(){return o.default},o.prototype.inject=function(t){for(const e of Object.keys(t)){const n=t[e];switch(e){case"hash":case"query":case"env":case"argv":case"config":continue}this.set(e,n)}},o.prototype.load=function(t){t.hash&&this.parseHash(t.hash),t.query&&this.parseQuery(t.query),t.env&&this.parseEnv(t.env),t.argv&&this.parseArg(t.argv),this.network=this.getNetwork(),this.prefix=this.getPrefix()},o.prototype.open=function(t){if(u.unsupported)return;const e=this.getFile(t);let n;try{n=u.readFileSync(e,"utf8")}catch(t){if("ENOENT"===t.code)return;throw t}this.parseConfig(n),this.network=this.getNetwork(),this.prefix=this.getPrefix()},o.prototype.set=function(t,e){c("string"==typeof t,"Key must be a string."),null!=e&&(t=(t=t.replace(/-/g,"")).toLowerCase(),this.options[t]=e)},o.prototype.has=function(t){return"number"==typeof t?(c(t>=0,"Index must be positive."),!(t>=this.argv.length)):(c("string"==typeof t,"Key must be a string."),t=t.replace(/-/g,""),t=t.toLowerCase(),null!=this.hash[t]||(null!=this.query[t]||(null!=this.args[t]||(null!=this.env[t]||(null!=this.data[t]||null!=this.options[t])))))},o.prototype.get=function(t,e){if(void 0===e&&(e=null),Array.isArray(t)){const n=t;for(const t of n){const e=this.get(t);if(null!==e)return e}return e}return"number"==typeof t?(c(t>=0,"Index must be positive."),t>=this.argv.length?e:null!=this.argv[t]?this.argv[t]:e):(c("string"==typeof t,"Key must be a string."),t=t.replace(/-/g,""),t=t.toLowerCase(),null!=this.hash[t]?this.hash[t]:null!=this.query[t]?this.query[t]:null!=this.args[t]?this.args[t]:null!=this.env[t]?this.env[t]:null!=this.data[t]?this.data[t]:null!=this.options[t]?this.options[t]:e)},o.prototype.typeOf=function(t){const e=this.get(t);return null===e?"null":typeof e},o.prototype.str=function(t,e){const n=this.get(t);if(void 0===e&&(e=null),null===n)return e;if("string"!=typeof n)throw new Error(`${i(t)} must be a string.`);return n},o.prototype.int=function(t,e){let n=this.get(t);if(void 0===e&&(e=null),null===n)return e;if("string"!=typeof n){if("number"!=typeof n)throw new Error(`${i(t)} must be an int.`);if(!Number.isSafeInteger(n))throw new Error(`${i(t)} must be an int.`);return n}if(!/^\-?\d+$/.test(n))throw new Error(`${i(t)} must be an int.`);if(n=parseInt(n,10),!Number.isSafeInteger(n))throw new Error(`${i(t)} must be an int.`);return n},o.prototype.uint=function(t,e){const n=this.int(t);if(void 0===e&&(e=null),null===n)return e;if(n<0)throw new Error(`${i(t)} must be a uint.`);return n},o.prototype.float=function(t,e){let n=this.get(t);if(void 0===e&&(e=null),null===n)return e;if("string"!=typeof n){if("number"!=typeof n)throw new Error(`${i(t)} must be a float.`);if(!isFinite(n))throw new Error(`${i(t)} must be a float.`);return n}if(!/^\-?\d*(?:\.\d*)?$/.test(n))throw new Error(`${i(t)} must be a float.`);if(!/\d/.test(n))throw new Error(`${i(t)} must be a float.`);if(n=parseFloat(n),!isFinite(n))throw new Error(`${i(t)} must be a float.`);return n},o.prototype.ufloat=function(t,e){const n=this.float(t);if(void 0===e&&(e=null),null===n)return e;if(n<0)throw new Error(`${i(t)} must be a positive float.`);return n},o.prototype.fixed=function(t,e,n){const o=this.float(t);if(void 0===n&&(n=null),null===o)return n;try{return d.fromFloat(o,e||0)}catch(e){throw new Error(`${i(t)} must be a fixed number.`)}},o.prototype.ufixed=function(t,e,n){const o=this.fixed(t,e);if(void 0===n&&(n=null),null===o)return n;if(o<0)throw new Error(`${i(t)} must be a positive fixed number.`);return o},o.prototype.bool=function(t,e){const n=this.get(t);if(void 0===e&&(e=null),null===n)return e;if("number"==typeof n){if(1===n)return!0;if(0===n)return!1}if("string"!=typeof n){if("boolean"!=typeof n)throw new Error(`${i(t)} must be a boolean.`);return n}if("true"===n||"1"===n)return!0;if("false"===n||"0"===n)return!1;throw new Error(`${i(t)} must be a boolean.`)},o.prototype.buf=function(t,e,n){const o=this.get(t);if(n||(n="hex"),void 0===e&&(e=null),null===o)return e;if("string"!=typeof o){if(!Buffer.isBuffer(o))throw new Error(`${i(t)} must be a buffer.`);return o}const r=Buffer.from(o,n);if(r.length!==Buffer.byteLength(o,n))throw new Error(`${i(t)} must be a ${n} string.`);return r},o.prototype.array=function(t,e){const n=this.get(t);if(void 0===e&&(e=null),null===n)return e;if("string"!=typeof n){if(!Array.isArray(n))throw new Error(`${i(t)} must be an array.`);return n}const o=n.trim().split(/\s*,\s*/),r=[];for(const t of o)0!==t.length&&r.push(t);return r},o.prototype.obj=function(t,e){const n=this.get(t);if(void 0===e&&(e=null),null===n)return e;if("object"!=typeof n)throw new Error(`${i(t)} must be an object.`);return n},o.prototype.func=function(t,e){const n=this.get(t);if(void 0===e&&(e=null),null===n)return e;if("function"!=typeof n)throw new Error(`${i(t)} must be a function.`);return n},o.prototype.path=function(t,e){let n=this.str(t);if(void 0===e&&(e=null),null===n)return e;switch(n[0]){case"~":n=p.join(f,n.substring(1));break;case"@":n=p.join(this.prefix,n.substring(1))}return p.normalize(n)},o.prototype.mb=function(t,e){const n=this.uint(t);return void 0===e&&(e=null),null===n?e:1024*n*1024},o.prototype.getNetwork=function(){let t=this.str("network");return t||(t="mainnet"),c(s(t),"Bad network."),t},o.prototype.getPrefix=function(){let t=this.str("prefix");if(t)return"~"===t[0]&&(t=p.join(f,t.substring(1))),t;t=p.join(f,`.${this.module}`);const e=this.str("network");return e&&(c(s(e),"Bad network."),"mainnet"!==e&&(t=p.join(t,e))),p.normalize(t)},o.prototype.getFile=function(t){const e=this.str("config");return e||p.join(this.prefix,t)},o.prototype.ensure=function(){return u.unsupported?Promise.resolve():u.mkdirp(this.prefix)},o.prototype.location=function(t){return p.join(this.prefix,t)},o.prototype.write=function(t,e){u.writeFileSync(this.location(t),e)},o.prototype.parseConfig=function(t){c("string"==typeof t,"Config must be text."),65279===t.charCodeAt(0)&&(t=t.substring(1)),t=(t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).replace(/\\\n/g,"");let e=!0,n=!1,i=0;for(const r of t.split("\n")){const t=r.trim();if(i+=1,0===t.length)continue;if("#"===t[0])continue;const s=t.indexOf("="),a=t.indexOf(":");let c=-1;if(-1!==a&&(a<s||-1===s)){if(n&&!e)throw new Error(`Expected '=' on line ${i}: "${t}".`);c=a,n=!0,e=!0}else{if(-1===s){const n=e?":":"=";throw new Error(`Expected '${n}' on line ${i}: "${t}".`)}if(n&&e)throw new Error(`Expected ':' on line ${i}: "${t}".`);c=s,n=!0,e=!1}let p=t.substring(0,c).trim();if(p=p.replace(/\-/g,""),!l(p))throw new Error(`Invalid option on line ${i}: ${p}.`);const h=t.substring(c+1).trim();if(0===h.length)continue;const u=o.alias[p];u&&(p=u),this.data[p]=h}},o.prototype.parseArg=function(t){t&&"object"==typeof t||(t=process.argv),c(Array.isArray(t));let e=null,n=!1;for(let i=2;i<t.length;i++){const r=t[i];if(c("string"==typeof r),"--"===r){n=!0;continue}if(n){this.pass.push(r);continue}if(0===r.length){e=null;continue}if(0===r.indexOf("--")){const t=r.indexOf("=");let n=null,i=null,s=!1;if(-1!==t?(n=r.substring(2,t),i=r.substring(t+1),e=null,s=!1):(n=r.substring(2),i="true",e=null,s=!0),n=n.replace(/\-/g,""),!l(n))throw new Error(`Invalid argument: --${n}.`);if(0===i.length)continue;if(n.length>1){const t=o.alias[n];t&&(n=t)}this.args[n]=i,s&&(e=n);continue}if("-"===r[0]){e=null;for(let t=1;t<r.length;t++){let n=r[t];if((n<"a"||n>"z")&&(n<"A"||n>"Z")&&(n<"0"||n>"9")&&"?"!==n)throw new Error(`Invalid argument: -${n}.`);const i=o.alias[n];i&&(n=i),this.args[n]="true",e=n}continue}const s=r;0!==s.length?e?(this.args[e]=s,e=null):this.argv.push(s):e=null}},o.prototype.parseEnv=function(t){let e=this.module;e=(e=e.toUpperCase()).replace(/-/g,"_"),e+="_",t&&"object"==typeof t||(t=process.env),c(t&&"object"==typeof t);for(let n of Object.keys(t)){const i=t[n];if(c("string"==typeof i),d.startsWith(n,e)&&(n=n.substring(e.length),n=n.replace(/_/g,""),function(t){return!!a(t)&&!/[a-z]/.test(t)}(n)&&0!==i.length)){if((n=n.toLowerCase()).length>1){const t=o.alias[n];t&&(n=t)}this.env[n]=i}}},o.prototype.parseQuery=function(t){if("string"!=typeof t){if(!global.location)return{};if("string"!=typeof(t=global.location.search))return{}}return this.parseForm(t,this.query)},o.prototype.parseHash=function(t){if("string"!=typeof t){if(!global.location)return{};if("string"!=typeof(t=global.location.hash))return{}}return this.parseForm(t,this.hash)},o.prototype.parseForm=function(t,e){if(c("string"==typeof t),0===t.length)return;let n="?";e===this.hash&&(n="#"),t[0]===n&&(t=t.substring(1));for(const n of t.split("&")){const t=n.indexOf("=");let i,s;if(-1!==t?(i=n.substring(0,t),s=n.substring(t+1)):(i=n,s="true"),i=r(i),i=i.replace(/\-/g,""),!l(i))continue;if(0===(s=r(s)).length)continue;const a=o.alias[i];a&&(i=a),e[i]=s}},t.exports=o},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);r.call(this),this.config=new h("wmcc"),this.config.inject(t),this.config.load(t),t.config&&this.config.open("wmcc.conf"),this.network=a.get(this.config.network),this.startTime=-1,this.bound=[],this.plugins=Object.create(null),this.stack=[],this.logger=null,this.workers=null,this.spv=!1,this.chain=null,this.fees=null,this.mempool=null,this.pool=null,this.miner=null,this.http=null,this.wallet=null,this.stratum=null,this.init()}const i=n(1),r=Core.utils.AsyncObject,s=Core.utils.util,a=Core.protocol.Network,l=Core.workers.WorkerPool,c=Core.crypto.secp256k1,p=Core.native,h=n(19),u=n(11);Object.setPrototypeOf(o.prototype,r.prototype),o.prototype.initOptions=function(){let t=new u;const e=this.config;e.has("logger")&&(t=e.obj("logger")),t.set({filename:e.bool("log-file")?e.location("debug.log"):null,level:e.str("log-level"),console:e.bool("log-console"),browser:e.bool("log-browser"),shrink:e.bool("log-shrink")}),this.logger=t.context("node"),this.workers=new l({enabled:e.bool("workers"),size:e.uint("workers-size"),timeout:e.uint("workers-timeout"),file:e.str("worker-file")})},o.prototype.init=function(){this.initOptions(),this.on("error",()=>{}),this.workers.on("spawn",t=>{this.logger.info("Spawning worker process: %d.",t.id)}),this.workers.on("exit",(t,e)=>{this.logger.warning("Worker %d exited: %s.",e.id,t)}),this.workers.on("log",(t,e)=>{this.logger.debug("Worker %d says:",e.id),this.logger.debug(t)}),this.workers.on("error",(t,e)=>{e?this.logger.error("Worker %d error: %s",e.id,t.message):this.emit("error",t)}),this.hook("preopen",()=>this.handlePreopen()),this.hook("preclose",()=>this.handlePreclose()),this.hook("open",()=>this.handleOpen()),this.hook("close",()=>this.handleClose())},o.prototype.ensure=function(){return this.config.ensure()},o.prototype.location=function(t){return this.config.location(t)},o.prototype.handlePreopen=async function(){await this.logger.open(),await this.workers.open(),this.bind(this.network.time,"offset",t=>{this.logger.info("Time offset: %d (%d minutes).",t,t/60|0)}),this.bind(this.network.time,"sample",(t,e)=>{this.logger.debug("Added time data: samples=%d, offset=%d (%d minutes).",e,t,t/60|0)}),this.bind(this.network.time,"mismatch",()=>{this.logger.warning("Adjusted time mismatch!"),this.logger.warning("Please make sure your system clock is correct!")})},o.prototype.handleOpen=async function(){this.startTime=s.now(),c.binding||(this.logger.warning("Warning: secp256k1-node was not built."),this.logger.warning("Verification will be slow.")),p.binding||(this.logger.warning("Warning: wmcc-native was not built."),this.logger.warning("Hashing will be slow.")),this.workers.enabled||(this.logger.warning("Warning: worker pool is disabled."),this.logger.warning("Verification will be slow."))},o.prototype.handlePreclose=async function(){},o.prototype.handleClose=async function(){for(const[t,e,n]of this.bound)t.removeListener(e,n);this.bound.length=0,this.startTime=-1,await this.workers.close(),await this.logger.close()},o.prototype.bind=function(t,e,n){this.bound.push([t,e,n]),t.on(e,n)},o.prototype.error=function(t){this.logger.error(t),this.emit("error",t)},o.prototype.uptime=function(){return-1===this.startTime?0:s.now()-this.startTime},o.prototype.use=function(t){i(t,"Plugin must be an object."),i("function"==typeof t.init,"`init` must be a function."),i(!this.loaded,"Cannot add plugin after node is loaded.");const e=t.init(this);if(i(!e.open||"function"==typeof e.open,"`open` must be a function."),i(!e.close||"function"==typeof e.close,"`close` must be a function."),t.id){switch(i("string"==typeof t.id,"`id` must be a string."),t.id){case"chain":case"fees":case"mempool":case"miner":case"pool":case"rpc":case"http":case"wallet":case"stratum":i(!1,`${t.id} is already added.`)}i(!this.plugins[t.id],`${t.id} is already added.`),this.plugins[t.id]=e}return this.stack.push(e),"function"==typeof e.on&&e.on("error",t=>this.error(t)),e},o.prototype.has=function(t){return null!=this.plugins[t]},o.prototype.get=function(t){switch(i("string"==typeof t,"Plugin name must be a string."),t){case"chain":return i(this.chain,"chain is not loaded."),this.chain;case"fees":return i(this.fees,"fees is not loaded."),this.fees;case"mempool":return i(this.mempool,"mempool is not loaded."),this.mempool;case"miner":return i(this.miner,"miner is not loaded."),this.miner;case"pool":return i(this.pool,"pool is not loaded."),this.pool;case"rpc":return i(this.rpc,"rpc is not loaded."),this.rpc;case"http":return i(this.http,"http is not loaded."),this.http;case"wallet":return i(this.wallet,"wallet is not loaded."),this.wallet;case"stratum":return i(this.stratum,"stratum is not loaded."),this.stratum}return this.plugins[t]||null},o.prototype.require=function(t){const e=this.get(t);return i(e,`${t} is not loaded.`),e},o.prototype.loadPlugins=function(){const t=this.config.array("plugins",[]),e=this.config.func("loader");for(let n of t)"string"==typeof n&&(i(e,"Must pass a loader function."),n=e(n)),this.use(n)},o.prototype.openPlugins=async function(){for(const t of this.stack)t.open&&await t.open()},o.prototype.closePlugins=async function(){for(const t of this.stack)t.close&&await t.close()},t.exports=o},function(module,exports,__webpack_require__){"use strict";function Browser(t,e){if(!(this instanceof Browser))return new Browser(t,e);this.doc=e,this.node=null,this.submit=null,this.init(t)}const Window=__webpack_require__(4),Loader=__webpack_require__(8),Submit=__webpack_require__(13),Path=__webpack_require__(0);Browser.prototype.init=function init(node){this.node=new node.FullNode({config:!0,argv:!0,env:!0,logFile:!0,logConsole:!0,logBrowser:!0,logLevel:"debug",db:"leveldb",persistent:!0,workers:!0,listen:!0,loader:eval("require")}),this.submit=new Submit(this.node),this.doc.onload=Loader.init(this.submit.node)},module.exports=Browser},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);this.node=t,this.events=[],this.init()}n(1),Core.utils.Lock;const i=Core.wmcc.Amount;o.prototype.init=function(){const t=this,e=(e,n)=>{let o=t.events.mempool;for(let i in o)t.emit(o[i].event,"mempool",o[i].el,{tx:e,view:n})};this.node.mempool.listeners("tx").filter(t=>t.toString()===e.toString()).length&&this.node.mempool.removeListener("tx",e),this.node.mempool.on("tx",e);const n=async(e,n)=>{let o=t.events.chain;for(let e in o)t.emit(o[e].event,"chain",o[e].el)};this.node.chain.listeners("block").filter(t=>t.toString()===n.toString()).length&&this.node.chain.removeListener("block",n),this.node.chain.on("block",n);const o=()=>{let e=t.events.balance;for(let n in e)t.emit(e[n].event,"balance",e[n].el)};this.node.walletdb.listeners("hook balance").filter(t=>t.toString()===o.toString()).length&&this.node.walletdb.removeListener("hook balance",o),this.node.walletdb.on("hook balance",o);const i=e=>{let n=t.events.miner;for(let o in n)t.emit(n[o].event,"miner",n[o].el,{attempt:e})};this.node.miner.listeners("miner block").filter(t=>t.toString()===i.toString()).length&&this.node.miner.removeListener("miner block",i),this.node.miner.on("miner block",i);const r=async(e,n)=>{let o=t.events.notification;for(let i in o)t.emit(o[i].event,"notification",o[i].el,{block:e,entry:n,prepend:!0})};this.node.miner.listeners("miner found").filter(t=>t.toString()===r.toString()).length&&this.node.miner.removeListener("miner found",r),this.node.miner.on("miner found",r),this.node.chain.db.on("rescan",()=>{t.node.walletdb.rescan(0)}),this.node.chain.db.on("block scan",(e,n)=>{$("preload").show(),$("preloadcontent").html(`<span class='scanning'>Scanning block ${n}: <a>${e}</a></span>`),t.node.chain.tip.height===n&&$("preload").hide()})},o.prototype.on=async function(t,e,n,o){this.events[e]||(this.events[e]=[]);const i={event:t,el:n};return this.events[e].filter((e,o)=>e.event===t||e.el===n).length||this.events[e].push(i),this.events[e]=this.events[e].map(t=>Object.assign(t,[i].find(e=>e&&t.event===e.event))),await this.emit(t,e,n,o)},o.prototype.add=async function(t,e,n,o){return await this.on(t,e,n,o)},o.prototype.emit=async function(t,e,n,o){try{let i;return i=o&&Object.keys(o).length?await this[t](...Object.values(o)):await this[t](),void(o&&o.append?n.append(i):o&&o.prepend?n.prepend(i):n.html(i))}catch(n){if("TypeError"!==n.name)throw n;console.log(`Unable to attach 'on' event for ${e}::${t}`)}},o.prototype.getBalance=async function(){return await this.node.info.wallet.getBalanceDetails(this.node.info.getAccountName())},o.prototype.getTotal=async function(t){const e=t||await this.getBalance();return i.text(e.total)},o.prototype.getAvailable=async function(t){const e=t||await this.getBalance();return i.text(e.available)},o.prototype.getPending=async function(t){const e=t||await this.getBalance();return i.text(e.pending)},o.prototype.getImmature=async function(t){const e=t||await this.getBalance();return i.text(e.immature)},o.prototype.getRecentTransactions=async function(){let t,e="";try{t=await this.node.info.wallet.getLast(this.node.info.wallet.account.name,5)}catch(t){return`<h2>${t}</h2>`}for(let n of t){n=await this.node.info.wallet.toDetails(n);const t=new Date(1e3*n.mtime).format("d-m-Y");let o=0,r=null;for(let t of n.inputs)t.path&&(o+=t.value,r="out"),0===n.time&&(r="out sending");if(o){o=0;for(let t of n.outputs)t.path||(o+=t.value,r="out")}else{for(let t of n.outputs)t.path&&(o+=t.value,r="in");0===n.time&&(r="in receiving"),n.tx.isCoinbase()&&(r="rig")}e+=`<holder><i class="glyph-icon flaticon-${r}"></i><span>`,e+=`<label>${t}</label><label>${i.wmcc(o,!0)} wmcc</label>`,e+=`<a><label class='r_goToExp' value="${n.hash}">Show Details</label></a></span></holder>`}return e||"<holder><h2>No recent transaction found.</h2></holder>"},o.prototype.getUnconfirmTxCount=function(){return this.node.mempool.getCount()},o.prototype.getUnconfirmTxSize=function(){return function(t){return t<1048576?(t/1024).toFixed(3):t<1073741824?(t/1024).toFixed(0):void 0}(this.node.mempool.getSize())},o.prototype.getLatestTxs=function(t,e){let n="";if(t){const e=[t.hash("hex"),t.getOutputValue()];if(!this._latesttxs.indexOf(e))return;this._latesttxs.push(e)}else this._latesttxs=[],this.node.mempool.map.forEach((t,e)=>{this._latesttxs.push([e,t.value])});const o=this._latesttxs.length,r=this._latesttxs.slice(Math.max(0,o-5),o);if(r.length){n+="<table>";for(let t=r.length-1;t>=0;t--)n+=`<tr><td><a title='${r[t][0]}' class='r_goToExp'>${r[t][0]}<a></td>`,n+=`<td>${i.wmcc(r[t][1],!0)}</td></tr>`;n+="</table>"}else n="<h2>No transaction in mempool.</h2>";return n},o.prototype.getCurrentBlock=async function(){let t="";const e=this.node.chain.height,n=this.node.chain.tip.rhash(),o=await this.node.chain.getEntry(e),r=await this.node.chain.getBlock(o.hash);return t+="<table>",t+=`<tr><td>Tip</td><td colspan='3'><a title='${n}'>${n}</a></td></tr>`,t+=`<tr><td>Hash</td><td colspan='3'><a title='${o.rhash()}' class='r_goToExp'>${o.rhash()}</a></td></tr>`,t+=`<tr><td>Height</td><td>${e}</td>`,t+=`<td>Age</td><td>${function(t,e){let n=e?t:Math.abs(Date.now()/1e3-t),o="",i={},r=0;const s={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};return Object.keys(s).forEach(function(t){i[t]=Math.floor(n/s[t]),n-=i[t]*s[t],i[t]&&r<1&&(r++,o+=` ${i[t]} ${t}${i[t]>1?"s":""}`)}),`${o}${e?"":" ago"}`}(o.time)}</td></tr>`,t+=`<tr><td>Txns<a></td><td>${r.txs.length}</td>`,t+=`<td>Outputs</td><td>${i.wmcc(r.getClaimed())} wmcc</td></tr>`,t+=`<tr><td>Size</td><td>${r.getVirtualSize()/1e3} kb</td>`,t+=`<td>Weight</td><td>${r.getWeight()/1e3} kwu</td></tr>`},o.prototype.destroy=async function(){},o.prototype.getMinerInfo=function(t){this._getMinerInfo&&!t&&(t=this._getMinerInfo);let e="<table>";return t?(this._getMinerInfo=t,e+=`<tr><td>Address</td><td colspan="3"><a title='${t.address}' class='r_goToExp'>${t.address}</a></td></tr>`,e+=`<tr><td>Height</td><td>${t.height}</td><td>Fees</td><td>${i.wmcc(t.fees)} wmcc</td></tr>`,e+=`<tr><td>Transactions</td><td>${t.items.length+1}</td><td>Difficulty</td><td>${function(t){let e=t>>>24&255,n=65535/(16777215&t);for(;e<29;)n*=256,e++;for(;e>29;)n/=256,e--;return n.toFixed(12)}(t.bits)}</td></tr>`):e+=`<tr><td colspan="2" class="ellipse">Address: ${this.node.info.getAddress()}</td></tr>`,e+="<table>"},o.prototype.minerFoundBlock=function(t,e){if("object"!=typeof t)return;let n="";return n+='<table class=\'minerfound\'><tr><th rowspan="3"><i class="glyph-icon flaticon-remove"></i><i class="glyph-icon flaticon-rig"></i></th>',n+='<th colspan="2">Found New Block!</th></tr>',n+=`<tr><td>Block height</td><td>: ${e.height}</td></tr>`,n+=`<tr><td>Block reward</td><td>: ${i.wmcc(t.txs[0].outputs[0].value)} wmcc</td></tr></table>`},t.exports=o},function(t,e,n){"use strict";function o(t){const e=r.hash160(t),n=Buffer.from(s.MAGIC_STRING+e,"utf8");return r.hash256(n)}const i=n(34),r=Core.crypto.digest,s=Core.http.RPCBase.MAGIC_STRING,a=Core.primitives.Address,l=Core.crypto.ccmp;t.exports={magicHash:o,sign:function(t,e,n){const r=o(t),s=i.sign(r,e);return function(t,e,n){return n&&(e+=4),Buffer.concat([Buffer.from([e+27]),t])}(s.signature,s.recovery,n)},verify:function(t,e,n){Buffer.isBuffer(n)||(n=new Buffer(n,"base64"));const s=function(t){if(65!==t.length)throw new Error("Invalid signature length");const e=t.readUInt8(0)-27;if(e>7)throw new Error("Invalid signature parameter");return{compressed:!!(4&e),recovery:3&e,signature:t.slice(1)}}(n),c=o(t),p=i.recover(c,s.signature,s.recovery,s.compressed),h=r.hash160(p),u=a.fromString(e);return l(h,u.hash)}}},function(t,e,n){"use strict";const o=t.exports;let i,r=[],s=[];o.encrypt=function(t,e){const n=o._UTF8.stringToBytes(t),i=o._utils.randomBytes(8),r=e.constructor==String?o._PBKDF2(e,i,32,{asBytes:!0}):e;return o._internal(n,r,o._utils.bytesToWords(i)),o._utils.bytesToHex(i.concat(n))},o.decrypt=function(t,e){const n=o._utils.hexToBytes(t),i=n.splice(0,8),r=e.constructor==String?o._PBKDF2(e,i,32,{asBytes:!0}):e;return o._internal(n,r,o._utils.bytesToWords(i)),o._UTF8.bytesToString(n)},o._internal=function(t,e,n){o._keysetup(e),n&&o._ivsetup(n);let i=[];for(let e=0;e<t.length;e++){if(e%16==0){o._nextstate(),i[0]=r[0]^r[5]>>>16^r[3]<<16,i[1]=r[2]^r[7]>>>16^r[5]<<16,i[2]=r[4]^r[1]>>>16^r[7]<<16,i[3]=r[6]^r[3]>>>16^r[1]<<16;for(let t=0;t<4;t++)i[t]=16711935&(i[t]<<8|i[t]>>>24)|4278255360&(i[t]<<24|i[t]>>>8);for(let t=120;t>=0;t-=8)i[t/8]=i[t>>>5]>>>24-t%32&255}t[e]^=i[e%16]}},o._keysetup=function(t){r[0]=t[0],r[2]=t[1],r[4]=t[2],r[6]=t[3],r[1]=t[3]<<16|t[2]>>>16,r[3]=t[0]<<16|t[3]>>>16,r[5]=t[1]<<16|t[0]>>>16,r[7]=t[2]<<16|t[1]>>>16,s[0]=o._utils.rotl(t[2],16),s[2]=o._utils.rotl(t[3],16),s[4]=o._utils.rotl(t[0],16),s[6]=o._utils.rotl(t[1],16),s[1]=4294901760&t[0]|65535&t[1],s[3]=4294901760&t[1]|65535&t[2],s[5]=4294901760&t[2]|65535&t[3],s[7]=4294901760&t[3]|65535&t[0],i=0;for(let t=0;t<4;t++)o._nextstate();for(let t=0;t<8;t++)s[t]^=r[t+4&7]},o._ivsetup=function(t){const e=o._utils.endian(t[0]),n=o._utils.endian(t[1]),i=e>>>16|4294901760&n,r=n<<16|65535&e;s[0]^=e,s[1]^=i,s[2]^=n,s[3]^=r,s[4]^=e,s[5]^=i,s[6]^=n,s[7]^=r;for(let t=0;t<4;t++)o._nextstate()},o._nextstate=function(){let t=[];for(let e=0;e<8;e++)t[e]=s[e];s[0]=s[0]+1295307597+i>>>0,s[1]=s[1]+3545052371+(s[0]>>>0<t[0]>>>0?1:0)>>>0,s[2]=s[2]+886263092+(s[1]>>>0<t[1]>>>0?1:0)>>>0,s[3]=s[3]+1295307597+(s[2]>>>0<t[2]>>>0?1:0)>>>0,s[4]=s[4]+3545052371+(s[3]>>>0<t[3]>>>0?1:0)>>>0,s[5]=s[5]+886263092+(s[4]>>>0<t[4]>>>0?1:0)>>>0,s[6]=s[6]+1295307597+(s[5]>>>0<t[5]>>>0?1:0)>>>0,s[7]=s[7]+3545052371+(s[6]>>>0<t[6]>>>0?1:0)>>>0,i=s[7]>>>0<t[7]>>>0?1:0;let e=[];for(let t=0;t<8;t++){const n=r[t]+s[t]>>>0,o=65535&n,i=n>>>16,a=((o*o>>>17)+o*i>>>15)+i*i,l=((4294901760&n)*n>>>0)+((65535&n)*n>>>0)>>>0;e[t]=a^l}r[0]=e[0]+(e[7]<<16|e[7]>>>16)+(e[6]<<16|e[6]>>>16),r[1]=e[1]+(e[0]<<8|e[0]>>>24)+e[7],r[2]=e[2]+(e[1]<<16|e[1]>>>16)+(e[0]<<16|e[0]>>>16),r[3]=e[3]+(e[2]<<8|e[2]>>>24)+e[1],r[4]=e[4]+(e[3]<<16|e[3]>>>16)+(e[2]<<16|e[2]>>>16),r[5]=e[5]+(e[4]<<8|e[4]>>>24)+e[3],r[6]=e[6]+(e[5]<<16|e[5]>>>16)+(e[4]<<16|e[4]>>>16),r[7]=e[7]+(e[6]<<8|e[6]>>>24)+e[5]},o._utils={randomBytes:function(t){let e=[];for(;t>0;t--)e.push(Math.floor(256*Math.random()));return e},randomHex:function(t){return o._utils.bytesToHex(o._utils.randomBytes(t))},wordsToBytes:function(t){let e=[];for(let n=0;n<32*t.length;n+=8)e.push(t[n>>>5]>>>24-n%32&255);return e},bytesToWords:function(t){let e=[];for(let n=0,o=0;n<t.length;n++,o+=8)e[o>>>5]|=t[n]<<24-o%32;return e},bytesToHex:function(t){let e=[];for(let n=0;n<t.length;n++)e.push((t[n]>>>4).toString(16)),e.push((15&t[n]).toString(16));return e.join("")},hexToBytes:function(t){let e=[];for(let n=0;n<t.length;n+=2)e.push(parseInt(t.substr(n,2),16));return e},wordsToHex:function(t){return new Buffer(Buffer.from(t).toString("hex"))},rotl:function(t,e){return t<<e|t>>>32-e},endian:function(t){if(t.constructor==Number)return 16711935&o._utils.rotl(t,8)|4278255360&o._utils.rotl(t,24);for(let e=0;e<t.length;e++)t[e]=o._utils.endian(t[e]);return t}},o._UTF8={stringToBytes:function(t){return o._Binary.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){try{return decodeURIComponent(escape(o._Binary.bytesToString(t)))}catch(t){throw new Error("ERROR DECODING URI: "+t.message)}}},o._Binary={stringToBytes:function(t){let e=[];for(let n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e},bytesToString:function(t){let e=[];for(let n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return e.join("")}},o._PBKDF2=function(t,e,n,i){function r(t,e){return o._HMAC(s,e,t,{asBytes:!0})}t.constructor==String&&(t=o._UTF8.stringToBytes(t)),e.constructor==String&&(e=o._UTF8.stringToBytes(e));const s=i&&i.hasher||o._SHA1,a=i&&i.iterations||1;let l=[],c=1;for(;l.length<n;){let n=r(t,e.concat(o._utils.wordsToBytes([c]))),i=n;for(let e=1;e<a;e++){i=r(t,i);for(let t=0;t<n.length;t++)n[t]^=i[t]}l=l.concat(n),c++}return l.length=n,i&&i.asBytes?l:i&&i.asString?o._Binary.bytesToString(l):o._utils.bytesToHex(l)},o._SHA1=function(t,e){const n=o._utils.wordsToBytes(o._SHA1._internal(t));return e&&e.asBytes?n:e&&e.asString?o._Binary.bytesToString(n):o._utils.bytesToHex(n)},o._SHA1._internal=function(t){t.constructor==String&&(t=o._UTF8.stringToBytes(t));let e=o._utils.bytesToWords(t),n=8*t.length,i=[],r=1732584193,s=-271733879,a=-1732584194,l=271733878,c=-1009589776;e[n>>5]|=128<<24-n%32,e[15+(n+64>>>9<<4)]=n;for(let t=0;t<e.length;t+=16){let n=r,o=s,p=a,h=l,u=c;for(let n=0;n<80;n++){if(n<16)i[n]=e[t+n];else{let t=i[n-3]^i[n-8]^i[n-14]^i[n-16];i[n]=t<<1|t>>>31}const o=(r<<5|r>>>27)+c+(i[n]>>>0)+(n<20?1518500249+(s&a|~s&l):n<40?1859775393+(s^a^l):n<60?(s&a|s&l|a&l)-1894007588:(s^a^l)-899497514);c=l,l=a,a=s<<30|s>>>2,s=r,r=o}r+=n,s+=o,a+=p,l+=h,c+=u}return[r,s,a,l,c]},o._HMAC=function(t,e,n,i){e.constructor==String&&(e=o._UTF8.stringToBytes(e)),n.constructor==String&&(n=o._UTF8.stringToBytes(n)),n.length>4*t._blocksize&&(n=t(n,{asBytes:!0}));let r=n.slice(0),s=n.slice(0);for(let e=0;e<4*t._blocksize;e++)r[e]^=92,s[e]^=54;const a=t(r.concat(t(s.concat(e),{asBytes:!0})),{asBytes:!0});return i&&i.asBytes?a:i&&i.asString?o._Binary.bytesToString(a):o._utils.bytesToHex(a)},t.exports=o},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);f.call(this,t),this.spv=!1,this.chain=new i({network:this.network,logger:this.logger,workers:this.workers,db:this.config.str("db"),prefix:this.config.prefix,maxFiles:this.config.uint("max-files"),cacheSize:this.config.mb("cache-size"),forceFlags:this.config.bool("force-flags"),bip91:this.config.bool("bip91"),bip148:this.config.bool("bip148"),prune:this.config.bool("prune"),checkpoints:this.config.bool("checkpoints"),coinCache:this.config.mb("coin-cache"),entryCache:this.config.uint("entry-cache"),indexTX:this.config.bool("index-tx"),indexAddress:this.config.bool("index-address")}),this.fees=new r(this.logger),this.fees.init(),this.mempool=new s({network:this.network,logger:this.logger,workers:this.workers,chain:this.chain,fees:this.fees,db:this.config.str("db"),prefix:this.config.prefix,persistent:this.config.bool("persistent-mempool"),maxSize:this.config.mb("mempool-size"),limitFree:this.config.bool("limit-free"),limitFreeRelay:this.config.uint("limit-free-relay"),requireStandard:this.config.bool("require-standard"),rejectAbsurdFees:this.config.bool("reject-absurd-fees"),replaceByFee:this.config.bool("replace-by-fee"),indexAddress:this.config.bool("index-address")}),this.pool=new a({network:this.network,logger:this.logger,chain:this.chain,mempool:this.mempool,prefix:this.config.prefix,selfish:this.config.bool("selfish"),compact:this.config.bool("compact"),bip37:this.config.bool("bip37"),bip151:this.config.bool("bip151"),bip150:this.config.bool("bip150"),identityKey:this.config.buf("identity-key"),maxOutbound:this.config.uint("max-outbound"),maxInbound:this.config.uint("max-inbound"),proxy:this.config.str("proxy"),onion:this.config.bool("onion"),upnp:this.config.bool("upnp"),seeds:this.config.array("seeds"),nodes:this.config.array("nodes"),only:this.config.array("only"),publicHost:this.config.str("public-host"),publicPort:this.config.uint("public-port"),host:this.config.str("host"),port:this.config.uint("port"),listen:this.config.bool("listen"),persistent:this.config.bool("persistent")}),this.miner=new l({network:this.network,logger:this.logger,workers:this.workers,chain:this.chain,mempool:this.mempool,address:this.config.array("coinbase-address"),coinbaseFlags:this.config.str("coinbase-flags"),preverify:this.config.bool("preverify"),maxWeight:this.config.uint("max-weight"),reservedWeight:this.config.uint("reserved-weight"),reservedSigops:this.config.uint("reserved-sigops")}),this.rpc=new p(this),c.unsupported||(this.http=new c({network:this.network,logger:this.logger,node:this,prefix:this.config.prefix,ssl:this.config.bool("ssl"),keyFile:this.config.path("ssl-key"),certFile:this.config.path("ssl-cert"),host:this.config.str("http-host"),port:this.config.uint("http-port"),apiKey:this.config.str("api-key"),noAuth:this.config.bool("no-auth")})),this.client=new g(this),this.walletdb=new h({network:this.network,logger:this.logger,workers:this.workers,client:this.client,prefix:this.config.prefix,db:this.config.str(["wallet-db","db"]),maxFiles:this.config.uint("wallet-max-files"),cacheSize:this.config.mb("wallet-cache-size"),witness:this.config.bool("wallet-witness"),checkpoints:this.config.bool("wallet-checkpoints"),startHeight:this.config.uint("wallet-start-height"),wipeNoReally:this.config.bool("wallet-wipe-no-really"),apiKey:this.config.str(["wallet-api-key","api-key"]),walletAuth:this.config.bool("wallet-auth"),noAuth:this.config.bool(["wallet-no-auth","no-auth"]),ssl:this.config.str("wallet-ssl"),host:this.config.str("wallet-host"),port:this.config.uint("wallet-port"),spv:this.spv,verify:this.spv,listen:!1}),this.stratum=new u({node:this,prefix:this.config.prefix,logger:this.logger,host:this.config.str("stratum-host"),port:this.config.uint("stratum-port"),publicHost:this.config.str("stratum-public-host"),publicPort:this.config.uint("stratum-public-port"),maxInbound:this.config.uint("stratum-max-inbound"),difficulty:this.config.uint("stratum-difficulty"),dynamic:this.config.bool("stratum-dynamic"),password:this.config.str("stratum-password")}),this.auth=new d({network:this.network,logger:this.logger,walletdb:this.walletdb,chain:this.chain,otp:this.config.bool("auth-otp"),alg:this.config.str("hsm-alg"),hash:this.config.str("hsm-hash"),iter:this.config.str("hsm-iter"),r:this.config.str("hsm-r"),p:this.config.str("hsm-p"),length:this.config.str("hsm-length")}),this.http&&this.walletdb.http&&this.walletdb.http.attach(this.http),this.walletdb.rpc.attach(this.rpc),this.info=new y(this),this.attach=new m(this),this._init()}const i=Core.blockchain.Chain,r=Core.txmempool.Fees,s=Core.txmempool.Mempool,a=Core.net.Pool,l=Core.mining.Miner,c=Core.http.Server,p=Core.http.RPC,h=Core.wallet.WalletDB,u=Core.stratum.Stratum,d=n(17),f=n(20),g=n(26),m=n(22),y=n(27);Object.setPrototypeOf(o.prototype,f.prototype),o.prototype._init=function(){this.chain.on("error",t=>this.error(t)),this.mempool.on("error",t=>this.error(t)),this.pool.on("error",t=>this.error(t)),this.miner.on("error",t=>this.error(t)),this.walletdb.on("error",t=>this.error(t)),this.stratum.on("error",t=>this.error(t)),this.http&&this.http.on("error",t=>this.error(t)),this.mempool.on("tx",t=>{this.miner.cpu.notifyEntry(),this.emit("tx",t)}),this.chain.hook("connect",async(t,e)=>{try{await this.mempool._addBlock(t,e.txs)}catch(t){this.error(t)}this.emit("block",e),this.emit("connect",t,e)}),this.chain.hook("disconnect",async(t,e)=>{try{await this.mempool._removeBlock(t,e.txs)}catch(t){this.error(t)}this.emit("disconnect",t,e)}),this.chain.hook("reorganize",async(t,e)=>{try{await this.mempool._handleReorg()}catch(t){this.error(t)}this.emit("reorganize",t,e)}),this.chain.hook("reset",async t=>{try{await this.mempool._reset()}catch(t){this.error(t)}this.emit("reset",t)}),this.loadPlugins()},o.prototype._open=async function(){await this.chain.open(),await this.mempool.open(),await this.miner.open(),await this.pool.open(),await this.walletdb.open(),await this.stratum.open(),await this.openPlugins(),this.http&&await this.http.open(),this.logger.info("Node is loaded.")},o.prototype._close=async function(){this.http&&await this.http.close(),await this.closePlugins(),await this.stratum.close(),await this.walletdb.close(),await this.pool.close(),await this.miner.close(),await this.mempool.close(),await this.chain.close(),this.logger.info("Node is closed.")},o.prototype.scan=function(t,e,n){return this.chain.scan(t,e,n)},o.prototype.broadcast=async function(t){try{await this.pool.broadcast(t)}catch(t){this.emit("error",t)}},o.prototype.sendTX=async function(t){let e;try{e=await this.mempool.addTX(t)}catch(e){if("VerifyError"===e.type&&0===e.score)return this.error(e),this.logger.warning("Verification failed for tx: %s.",t.txid()),this.logger.warning("Attempting to broadcast anyway..."),void this.broadcast(t);throw e}if(e)return this.logger.warning("TX was orphaned in mempool: %s.",t.txid()),this.logger.warning("Attempting to broadcast anyway..."),void this.broadcast(t);this.pool.options.selfish&&this.pool.broadcast(t)},o.prototype.relay=async function(t){try{await this.sendTX(t)}catch(t){this.error(t)}},o.prototype.connect=function(){return this.pool.connect()},o.prototype.disconnect=function(){return this.pool.disconnect()},o.prototype.startSync=function(){return this.pool.startSync()},o.prototype.stopSync=function(){return this.pool.stopSync()},o.prototype.getBlock=function(t){return this.chain.getBlock(t)},o.prototype.getCoin=async function(t,e){const n=this.mempool.getCoin(t,e);return n||(this.mempool.isSpent(t,e)?null:await this.chain.getCoin(t,e))},o.prototype.getCoinsByAddress=async function(t){const e=this.mempool.getCoinsByAddress(t),n=await this.chain.getCoinsByAddress(t),o=[];for(const t of n){this.mempool.isSpent(t.hash,t.index)||o.push(t)}for(const t of e)o.push(t);return o},o.prototype.getMetaByAddress=async function(t){const e=this.mempool.getMetaByAddress(t);return(await this.chain.getMetaByAddress(t)).concat(e)},o.prototype.getMeta=async function(t){const e=this.mempool.getMeta(t);return e||await this.chain.getMeta(t)},o.prototype.getMetaView=async function(t){return-1===t.height?this.mempool.getSpentView(t.tx):this.chain.getSpentView(t.tx)},o.prototype.getTXByAddress=async function(t){const e=await this.getMetaByAddress(t),n=[];for(const t of e)n.push(t.tx);return n},o.prototype.getTX=async function(t){const e=await this.getMeta(t);return e?e.tx:null},o.prototype.hasTX=async function(t){return!!this.mempool.hasEntry(t)||await this.chain.hasTX(t)},o.prototype._on=async function(t,e,n){return await this.attach.on(t,e,n)},o.prototype._emit=async function(t,e){return await this.attach.emit(t,e)},o.prototype._call=async function(t,e,n){return n&&Object.keys(n).length?await this[e][t](...Object.values(n)):await this[e][t]()},t.exports=o},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);i.call(this),this.node=t,this.network=t.network,this.filter=null,this.listen=!1,this._init()}const i=Core.utils.AsyncObject;Object.setPrototypeOf(o.prototype,i.prototype),o.prototype._init=function(){this.node.on("connect",(t,e)=>{this.listen&&this.emit("block connect",t,e.txs)}),this.node.on("disconnect",(t,e)=>{this.listen&&this.emit("block disconnect",t)}),this.node.on("tx",t=>{this.listen&&this.emit("tx",t)}),this.node.on("reset",t=>{this.listen&&this.emit("chain reset",t)})},o.prototype._open=function(t){return this.listen=!0,Promise.resolve()},o.prototype._close=function(){return this.listen=!1,Promise.resolve()},o.prototype.getTip=function(){return Promise.resolve(this.node.chain.tip)},o.prototype.getEntry=async function(t){const e=await this.node.chain.getEntry(t);return e&&await this.node.chain.isMainChain(e)?e:null},o.prototype.send=function(t){return this.node.relay(t),Promise.resolve()},o.prototype.setFilter=function(t){return this.filter=t,this.node.pool.setFilter(t),Promise.resolve()},o.prototype.addFilter=function(t){return this.node.pool.queueFilterLoad(),Promise.resolve()},o.prototype.resetFilter=function(){return this.node.pool.queueFilterLoad(),Promise.resolve()},o.prototype.estimateFee=async function(t){return this.node.fees?this.node.fees.estimateFee(t):this.network.feeRate},o.prototype.rescan=function(t){return this.node.chain.scan(t,this.filter,(t,e)=>this.fire("block rescan",t,e))},t.exports=o},function(module,exports,__webpack_require__){"use strict";function Info(t){if(!(this instanceof Info))return new Info(t);this.info=null,this.node=t,this.wallet=t.wallet||null,this.account=t.wallet?t.wallet.account:null,this.explorer={isHome:!0}}function toDifficulty(t){let e=t>>>24&255,n=65535/(16777215&t);for(;e<29;)n*=256,e++;for(;e>29;)n/=256,e--;return n.toFixed(12)}function substract(t,e,n=8){const o=Math.pow(10,n);return(t*o-e*o).toFixed(0)/o}function sum(t,e,n=8){const o=Math.pow(10,n);return(t*o+e*o).toFixed(0)/o}function compare(t,e){const n=t.time?t.time:t.mtime,o=e.time?e.time:e.mtime;return n<o?1:o<n?-1:0}function toTxTable(t,e){let n="",o=!1;if(Object.keys(t.input).length)for(let i in t.input)i===e?(n+=`<div><span>${i}</span>`,o=!0):t.pending.includes(i)?n+=`<div><i class="glyph-icon flaticon-copy next" title="Copy"></i>\n          <span class='red address r_goToExp' title='Output from unconfirmed transaction'>${i}</span>`:n+=`<div><i class="glyph-icon flaticon-copy next" title="Copy"></i><span class='address r_goToExp'>${i}</span>`,n+=`<span class='value'>${Amount.wmcc(t.input[i],!0)} wmcc</span></div>`;else n+="<div><span class='coinbase'>No Inputs (Newly Generated Coins)</span></div>";n+=`</td><td><i class="glyph-icon flaticon-${o?"out red":"in green"}"></i></td><td>`;for(let o in t.output)n+="<div>",n+="unknown"===o?"<a class='unparsed'>Unparsed output address</a>":o===e?`<div><i class="glyph-icon flaticon-copy next" title="Copy"></i><span>${o}</span>`:`<i class="glyph-icon flaticon-copy next" title="Copy"></i><span class='address r_goToExp'>${o}</span>`,n+=`<span class='value'>${Amount.wmcc(t.output[o],!0)} wmcc</span></div>`;return n}function page(t,e,n,o){let i="";const r=e-n,s=e+n,a=parseInt(e/n+1),l=Math.ceil(t/n),{start:c,end:p}=median(a,l,10);i+=`<div class="page"><a ${0===e?'class="disable"':'class="'+o+'" offset="'+r+'" limit="'+n+'"'}>&#9668;</a>`;for(let t=c;t<p;t++)i+=`<a ${a===t+1?'class="active"':'class="'+o+'" offset="'+n*t+'" limit="'+n+'"'}>${t+1}</a>`;return i+=`<a ${s+1>t?'class="disable"':'class="'+o+'" offset="'+s+'" limit="'+n+'"'}>&#9658;</a></div>`}function age(t,e){let n=e?t:Math.abs(Date.now()/1e3-t),o="",i={},r=0;const s={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};return Object.keys(s).forEach(function(t){i[t]=Math.floor(n/s[t]),n-=i[t]*s[t],i[t]&&r<2&&(r++,o+=` ${i[t]} ${t}${i[t]>1?"s":""}`)}),`${o}${e?"":" ago"}`}function filtermeta(t){return t.filter(function(t,e,n){return n[e].tx._hhash!==t.tx._hhash})}function filtermeta(t){let e=[];return t.filter(function(t){return-1===e.indexOf(t.tx._hhash)&&(e.push(t.tx._hhash),!0)})}function median(t,e,n){let o=Math.max(0,t-n/2);const i=Math.min(o+n,e);return o=Math.max(0,Math.min(i-n,i)),{start:o,end:i}}const Address=Core.primitives.Address,Account=Core.wallet.Account,Amount=Core.wmcc.Amount,Encoding=Core.utils.encoding,Util=Core.utils.util,Consensus=Core.protocol.consensus,Policy=Core.protocol.policy;Info.prototype.getWalletID=function(){return this.wallet.id},Info.prototype.getAccounts=function(){return this.wallet.getAccounts()},Info.prototype.getAccount=function(){return this.wallet.account},Info.prototype.getAccountName=function(){return this.wallet.account.name},Info.prototype.getTempReceive=function(){return this.wallet.getTempReceive().toString()},Info.prototype.createReceive=async function(){const t=await this.getAccountName();await this.wallet.createReceive(t);return this.getTempReceive()},Info.prototype.estimateFee=async function(){let t=await this.node.walletdb.estimateFee();return Amount.wmcc(t)},Info.prototype.estimatePri=async function(){let t=await this.node.fees.estimatePriority();return 0===t&&(t=this.node.fees.minTrackedPri),Amount.wmcc(t)},Info.prototype.isMinerStarted=function(){return this.node.miner.cpu.running},Info.prototype.startMining=async function(){try{return await this.node.miner.cpu.start()}catch(t){}},Info.prototype.stopMining=async function(){try{return await this.node.miner.cpu.stop()}catch(t){this.node.miner.reset(!1)}},Info.prototype.getAddress=function(){return this.node.miner.getAddress().toString()},Info.prototype.getWalletInfo=async function(){let t="";const e=this.wallet.toJSON(!0);return t+=`<holder><i class="glyph-icon flaticon-wallets"></i><span>${e.id} <a>Wallet Name</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-id"></i><span>${e.wid} <a>Wallet ID</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-account"></i><span>${e.account.name} <a>Account Name</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-account-lock"></i><span>${e.account.type.toUpperCase()} <a>Account Type</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-swap"></i><span>${e.state.tx} <a>Number of Transactions</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-network"></i><span>${e.network.toUpperCase()} <a>Network</a></span></holder>`},Info.prototype.getWalletDetails=async function(){let t="<table>";const e=this.wallet.toJSON(!0),n=e.account.accountKey,{tx:o,coin:i,confirmed:r,unconfirmed:s}=e.state;return t+=`<tr><td>Wallet Name</td><td colspan="2">${e.id}</td></tr>`,t+=`<tr><td>Wallet ID</td><td colspan="2">${e.wid}</td></tr>`,t+=`<tr><td>Wallet Key</td><td>${e.chksum.toString("hex")}★★★★★</td>`,t+='<td><i class="glyph-icon flaticon-copy" title="Copy"></i></td></tr>',t+=`<tr><td>Token</td><td title="${e.token}">${e.token.slice(0,32)}...</td>`,t+=`<td><i class="glyph-icon flaticon-copy" value="${e.token}" title="Copy"></i></td></tr>`,t+=`<tr><td>Account Name</td><td colspan="2">${e.account.name}</td></tr>`,t+=`<tr><td>Account Public Key</td><td title="${n}">${n.slice(0,32)}...</td>`,t+=`<td><i class="glyph-icon flaticon-copy" value="${n}" title="Copy"></i></td></tr>`,t+=`<tr><td>Account Type</td><td colspan="2">${e.account.type.toUpperCase()}</td></tr>`,t+=`<tr><td>Number of Transactions</td><td colspan="2">${o}</td></tr>`,t+=`<tr><td>Number of Coins</td><td colspan="2">${i}</td></tr>`,t+=`<tr><td>Confirm Balance</td><td colspan="2">${Amount.wmcc(r,!0)} wmcc</td></tr>`,t+=`<tr><td>Unconfirm Balance</td><td colspan="2">${Amount.wmcc(s,!0)} wmcc</td></tr>`,t+=`<tr><td>Network</td><td colspan="2">${e.network.toUpperCase()}</td></tr>`,t+=`<tr><td>Watch Only</td><td colspan="2">${e.watchOnly.toString().toUpperCase()}</td></tr>`,t+="</table>"},Info.prototype.getWalletHistory=async function(t,e){t=parseInt(t)||10,e=parseInt(e)||0;const n=await this.wallet.getTransactions(this.wallet.account.name,t,e);return await this.getWalletHistoryTable(n,{limit:t,offset:e})},Info.prototype.getWalletHistoryTable=async function(t,e){if(0===t.length)return`<h2>No transactions found in wallet <span>${this.wallet.id}</span> for account <span>${this.wallet.account.name}.</span></h2>`;let n="<table><tr><th>Date/Time</th><th>Status</th><th>Height</th><th>Transactions Hash</th><th>Value</th></tr>";for(let o=0;o<t.length;o++){const i=new Date(1e3*t[o].mtime).format("M j, Y, g:i a");let r;let s=0,a=!1;if(t[o].inputs[0].address)for(let e=0;e<t[o].inputs.length;e++)t[o].inputs[e].path&&(s+=t[o].inputs[e].value,a=!0,r="Sent",0===t[o].time&&(r="Sending"));for(let n=0;n<t[o].outputs.length;n++)if(t[o].outputs[n].path){if(a?s-=t[o].outputs[n].value:s+=t[o].outputs[n].value,r)continue;r="Received",0===t[o].time&&(r="Receiving"),t[o].tx.isCoinbase()&&(r=e.pending?"Staled":"Mined")}let l=0;try{l=Amount.wmcc(s)}catch(e){console.log(e),console.log(t[o]),console.log(s),l="unknown"}n+="<tr>",n+=`<td>${i}</td>`,n+=`<td>${r}</td>`,t[o].block?n+=`<td title="${Util.revHex(t[o].block)}"><a class='r_goToExp'>${t[o].height}</a></td>`:n+="<td>N/A</td>",n+=`<td title="${t[o].hash}"><a class='r_goToExp'>${t[o].hash}</a></td>`,n+=`<td>${l}</td>`,n+="</tr>"}if(n+="</table>",!e.limit)return n;const o=await this.wallet.getPending(this.wallet.account.name);return n+=page(await this.wallet.getTotal(this.wallet.account.name)-o.length,e.offset,e.limit,"r_walletGetHistory")},Info.prototype.getWalletPendingTx=async function(){const t=await this.wallet.getPendingDetails(this.wallet.account.name);return await this.getWalletHistoryTable(t,{pending:!0})},Info.prototype.setGenSearchAddress=async function(t){let e="",n=null;try{n=Address.fromString(t)}catch(n){return e+='<div class="error"><h2>Opps! Invalid address format</h2><span>',e+=`<a>${t}</a> is not a valid WMCC Address.<br>Please check and try again.</span>`,e+='<submit class="button r_genGotoAddresses">BACK</submit></div>'}if(!await this.wallet.getPath(n))return e+='<div class="error"><h2>Opps! Address not found</h2><span>Cannot find <a>',e+=`${t}</a> in this wallet (<a>${this.wallet.id}</a>).</span>`,e+='<submit class="button r_genGotoAddresses">BACK</submit></div>';await this.setExpAddress(t);const{metatx:o,coins:i}=this.explorer.details;let r=0;for(let t of i)r+=t.value;let s=0;for(let t of o)for(let e of t.tx.outputs){let t=e.getAddress()?e.getAddress().hash:Buffer.alloc(0);n.hash.equals(t)&&(s+=e.value)}const a=$('<div id="qrcode"></div>').qrcode(n.hash.toString("hex"))[0].childNodes[0].toDataURL("image/png"),l=o.length?`<i class="glyph-icon flaticon-record r_goToExp" value=${t} title="View Transactions"></i>`:"";return e+=`<div class="address"><img src="${a}"/><h2>Your WMCC Address</h2><table>`,e+=`<tr><td>Number of Transactions</td><td><span>${o.length}${l}</span></td></tr>`,e+=`<tr><td>Total Received</td><td><span>${Amount.wmcc(s,!0)} wmcc</span></td></tr>`,e+=`<tr><td>Address Hash 160</td><td><span class='address'>${n.hash.toString("hex")}</span></td></tr>`,e+=`<tr><td>Final Balance</td><td><span>${Amount.wmcc(r,!0)} wmcc</span></td></tr>`,e+="</table>",e+=`<p><a>This is Your WMCC Address.</a><a class="address">${t}</a>`,e+="<a>Share this with anyone so they can send you wmcoins.</a>",e+='<submit class="button r_genGotoAddresses">BACK</submit></p></div>'},Info.prototype.getGenAddress=async function(t=10,e=0){t=parseInt(t)||10,e=parseInt(e)||0;let n="<table><tr><th>Type</th><th>Address</th><th>Hash 160</th><th></th></tr>";const o=await this.wallet.getAccountPaths(this.wallet.account.name),i=t+e>o.length?o.length:e+t;for(let t=e;t<i;t++){const e=o[t].toAddress();n+=`<tr><td>${e.getType()}</td><td><a class='r_genGotoAddress' title='${e}'>${e}</a></td>`,n+=`<td><a title='${o[t].hash}'>${o[t].hash}</a></td>`,n+=`<td><i class="glyph-icon flaticon-copy r_genCopyAddress" value="${e}" title="Copy to clipboard"></i>`,n+='<i class="glyph-icon flaticon-gear r_walletManageAddress" title="Manage address"></i></td></tr>'}n+="</table>";return n+=page(o.length,e,t,"r_genGotoAddresses")},Info.prototype.getExpLatestBlocks=async function(t=5){if(!this.explorer.isHome)return"";const e=this.node.chain.height,n=parseInt(t);let o="<h1>Latest Blocks</h1><table class='home'><tr><th>Height</th><th>Age</th><th>Transactions</th><th>Total Output (wmcc)</th><th>Size (kb)</th><th>Weight (kwu)</th></tr>";for(let t=e;t>e-n&&t>-1;t--){const e=await this.node.chain.getEntry(t),n=await this.node.chain.getBlock(e.hash);o+=`<tr><td class='block r_goToExp'>${e.height}</td>`,o+=`<td>${age(e.time)}</td>`,o+=`<td>${n.txs.length}</td>`,o+=`<td>${Amount.wmcc(n.getClaimed())}</td>`,o+=`<td>${n.getVirtualSize()/1e3}</td>`,o+=`<td>${n.getWeight()/1e3}</td></tr>`}return o+="</table>"},Info.prototype.getExpLatestTransaction=async function(t=10){if(!this.explorer.isHome)return"";let e="<h1>Latest Transactions</h1>";if(!this.node.mempool.map.size)return e+'<h2 class="empty">No latest transaction found.</h2>';const n=parseInt(t);let o=0;return e+="<table class='home'><tr><th>Transaction Hash</th><th>Size (bytes)</th><th>Value (wmcc)</th></tr>",this.node.mempool.map.forEach((t,i)=>{n>o&&(e+=`<tr><td class='tx r_goToExp'>${i}</td>`,e+=`<td>${t.size}</td>`,e+=`<td>${Amount.wmcc(t.value,!0)}</td></tr>`,o++)}),e+="</table>"},Info.prototype.setExpBlockByHeight=async function(t){try{const e=parseInt(t,10),n=await this.node.chain.getEntry(e),o=await this.node.chain.getBlock(n.hash);return this.explorer.details={entry:n,block:o},n.height||!1}catch(t){return!1}},Info.prototype.setExpBlockByHash=async function(t){try{const e=await this.node.chain.getEntry(Util.revHex(t)),n=await this.node.chain.getBlock(Util.revHex(t));return this.explorer.details={entry:e,block:n},e.rhash()||!1}catch(t){return!1}},Info.prototype.getExpBlockByHeight=function(t){const{entry:e}=this.explorer.details;return e?e.height:this.setExpBlockByHeight(t||this.node.chain.tip.height)},Info.prototype.getExpHash=function(){return this.explorer.details.entry.rhash()},Info.prototype.getExpPrevHash=function(){const{entry:t}=this.explorer.details;return t.prevBlock!==Encoding.NULL_HASH?Util.revHex(t.prevBlock):null},Info.prototype.getExpNextHash=async function(){const{entry:t}=this.explorer.details,e=await this.node.chain.getNextHash(t.hash);return e?Util.revHex(e):null},Info.prototype.getExpMerkleRoot=function(){const{entry:t}=this.explorer.details;return Util.revHex(t.merkleRoot)},Info.prototype.getExpChainwork=function(){const{entry:t}=this.explorer.details;return t.chainwork.toString("hex",64)},Info.prototype.getExpTxCount=function(){const{block:t}=this.explorer.details;return t.txs.length},Info.prototype.getExpHeight=function(){return this.explorer.details.entry.height},Info.prototype.getExpTimestamp=function(){const{entry:t}=this.explorer.details;return`${new Date(1e3*t.time).format("F j, Y, h:i:s A")}`},Info.prototype.getExpDifficulty=function(){return toDifficulty(this.getExpBits())},Info.prototype.getExpBits=function(){return this.explorer.details.entry.bits},Info.prototype.getExpNonce=function(){return this.explorer.details.entry.nonce},Info.prototype.getExpConfirmation=function(){const{entry:t}=this.explorer.details;return this.node.chain.height-t.height+1},Info.prototype.getExpVersion=function(){const{entry:t}=this.explorer.details;return`0x${Util.hex32(t.version)}`},Info.prototype.getExpSize=function(){const{block:t}=this.explorer.details;return`${t.getVirtualSize()} bytes`},Info.prototype.getExpWeight=function(){const{block:t}=this.explorer.details;return`${t.getWeight()} bytes`},Info.prototype.getExpTotalOut=function(){const{txs:t}=this.explorer.details.block;let e=0;for(let n of t)for(let t of n.outputs)e+=t.value;return`${Amount.wmcc(e,!0)} wmcc`},Info.prototype.getExpFee=function(){const{txs:t}=this.explorer.details.block,{height:e}=this.explorer.details.entry;if(0===e)return"0 wmcc";for(let n of t)if(n.isCoinbase()){const t=Consensus.getReward(e),o=n.outputs[0].value;return`${Amount.wmcc(o-t,!0)} wmcc`}},Info.prototype.getExpTransactions=async function(){let t="",e=null;const{time:n}=this.explorer.details.block,{txs:o}=this.explorer.details.block;for(let i of o){const o=new Date(1e3*n).format("M d, Y, g:i:s A"),r=Util.revHex(i.txid());t+='<table class="transaction"><colgroup><col/><col/><col/></colgroup>',t+=`<tr><th colspan="2"><a class='tx r_goToExp'>${r}</a><i class="glyph-icon flaticon-copy" value=${r} title="Copy"></i>\n      </th><th>${o}</th></tr><tr><td>`;const{details:s,totalout:a,totalin:l}=await this.toDetails(i);t+=toTxTable(s),t+=`</td></tr><tr><td colspan='2'>${e=i.isCoinbase()?`(Size: ${i.getVirtualSize()} bytes)`:`(Fee: ${Amount.wmcc(l-a,!0)} wmcc, Size: ${i.getVirtualSize()} bytes)`}</td><td>${Amount.wmcc(a,!0)} wmcc</td></tr></table>`}return t},Info.prototype.setExpAddress=async function(t){try{const e=Address.fromString(t),n=await this.node.chain.getMetaByAddress(t),o=await this.node.chain.getCoinsByAddress(t),i=await this.node.mempool.getAllMetaByAddress(e);return n.push.apply(n,filtermeta(i)),n.sort(compare),this.explorer.details={address:e,metatx:n,coins:o},e||!1}catch(t){return!1}},Info.prototype.getExpAddress=function(){return`(${this.explorer.details.address})`},Info.prototype.getExpAddressSummary=function(){const{address:t,metatx:e,coins:n}=this.explorer.details;let o="",i=0;const r=$('<div id="qrcode"></div>').qrcode(t.hash.toString("hex"))[0].childNodes[0].toDataURL("image/png");for(let t of n)i+=t.value;let s=0;for(let n of e)for(let e of n.tx.outputs){let n=e.getAddress()?e.getAddress().hash:Buffer.alloc(0);t.hash.equals(n)&&(s+=e.value)}return o+='<table class="summary address"><tr><th colspan="5">Summary</th></tr>',o+=`<tr><td>Number of Transactions</td><td><span>${e.length}</span></td><td></td>`,o+=`<td>Total Received</td><td><span>${Amount.wmcc(s,!0)} wmcc</span></td></tr>`,o+=`<tr><td>Address Hash 160</td><td><span class='address'>${t.hash.toString("hex")}</span></td><td></td>`,o+=`<td>Final Balance</td><td><span>${Amount.wmcc(i,!0)} wmcc</span></td></tr>`,o+=`</table><img src="${r}"/>`},Info.prototype.getExpAdressTransactions=async function(t,e){t=parseInt(t)||50,e=parseInt(e)||0;let n="",o=null;const{metatx:i,address:r}=this.explorer.details,s=t+e>i.length?i.length:e+t;for(let t=e;t<s;t++){const e=new Date(1e3*(i[t].time||i[t].mtime)).format("M d, Y, g:i:s A"),s=i[t].tx.txid();n+='<table class="transaction"><colgroup><col/><col/><col/></colgroup>',n+=`<tr><th colspan="2"><a class='tx r_goToExp${i[t].block?"":" red' title='Unconfirmed transaction"}'>${Util.revHex(s)}</a>\n      <i class="glyph-icon flaticon-copy" value=${Util.revHex(s)} title="Copy"></i></th><th>${e}</th></tr><tr><td>`;const{details:a,totalout:l,totalin:c}=await this.toDetails(i[t].tx);n+=toTxTable(a,r.toString()),n+=`</td></tr><tr><td colspan='2'>${o=i[t].tx.isCoinbase()?`(Size: ${i[t].tx.getVirtualSize()} bytes)`:`(Fee: ${Amount.wmcc(c-l,!0)} wmcc, Size: ${i[t].tx.getVirtualSize()} bytes)`}</td><td>${Amount.wmcc(l,!0)} wmcc</td></tr></table>`}if(!n)return`<div class='empty'>No transaction found for address: <a>${r}</a></div>`;return n+=page(i.length,e,t,"r_getExpAdressTransactions")},Info.prototype.setExpTransaction=async function(t){try{return this.explorer.details=await this.node.chain.getMeta(t),this.explorer.details||!1}catch(t){return!1}},Info.prototype.getExpTransaction=function(){return`(${Util.revHex(this.explorer.details.tx.txid())})`},Info.prototype.getExpTransactionSummary=async function(){let t="";const{tx:e,time:n,mtime:o,height:i,block:r}=this.explorer.details,s=new Date(1e3*(n||o)).format("M d, Y, g:i:s A"),{details:a,totalout:l,totalin:c}=await this.toDetails(e);let p=0,h=0;e.isCoinbase()||(p=Amount.wmcc(c,!0),h=c-l);const u=h>0?Amount.wmcc(Policy.getRate(e.getVirtualSize(),h),!0):0,d=h>0?Amount.wmcc(Policy.getRate(e.getWeight(),h),!0):0,f=i<0?"N/A":i,g=i<0?"":Util.revHex(r),m=i<0?"Unconfirmed Transaction":this.node.chain.height-i+1;return t+='<table class="summary"><tr><th colspan="5">Summary</th></tr>',t+=`<tr><td>Size</td><td><span>${e.getVirtualSize()} bytes</span></td><td></td>`,t+=`<td>Total Input</td><td><span>${p} wmcc</span></td></tr>`,t+=`<tr><td>Weight</td><td><span>${e.getWeight()} bytes</span></td><td></td>`,t+=`<td>Total Output</td><td><span>${Amount.wmcc(l,!0)} wmcc</span></td></tr>`,t+=`<tr><td>Received Time</td><td><span>${s}</span></td><td></td>`,t+=`<td>Fees</td><td><span>${Amount.wmcc(h,!0)} wmcc</span></td></tr>`,t+=`<tr><td>Included In Block</td><td><span${i<0?"":" class='block r_goToExp"}' title='${g}'>${f}</span></td><td></td>`,t+=`<td>Fee per kilobyte</td><td><span>${u} wmcc/kb</span></td></tr>`,t+=`<tr><td>Confirmations</td><td><span>${m}</span></td><td></td>`,t+=`<td>Fee per weight unit</td><td><span>${d} wmcc/kwu</span></td></tr>`,t+="</table>"},Info.prototype.getExpTransactionTable=async function(){let t="";const{tx:e}=this.explorer.details,n=Util.revHex(e.txid());t+='<table class="transaction"><colgroup><col/><col/><col/></colgroup>',t+=`<tr><th colspan="3"><a class='tx'>${n}</a><i class="glyph-icon flaticon-copy" value=${n} title="Copy"></i></th></tr><tr><td>`;const{details:o}=await this.toDetails(e);return t+=toTxTable(o),t+="</td></tr></table>"},Info.prototype.getExpScripts=function(){let t="";const{inputs:e,outputs:n}=this.explorer.details.tx;t+='<div class="scripts">',"coinbase"===e[0].getType()?t+="<h2>Coinbase</h2>":t+="<h2>Input Scripts</h2><div>";for(let n of e){const e=n.script.toJSON(),o=n.witness.toString(),i=n.script.getCommitment();e&&(t+=`<h3>${n.script.getInputTypeVal()}</h3>`,t+=`<p>${e}</p>`),i&&(t+="<h3>Commitment hash</h3>",t+=`<p>${i.toString("hex")}</p>`),o&&(t+=`<h3>${n.witness.getInputTypeVal()}</h3>`,t+=`<p>${o}</p>`)}t+='</div><div class="scripts"><h2>Output Scripts</h2>';for(let e of n){t+=`<h3>${e.getType()}</h3>`,t+=`<span>${e.script.toString()}</span>`;const n=e.script.getCommitment();n&&(t+="<h3>Commitment hash</h3>",t+=`<span>${n.toString("hex")}</span>`)}return`${t}</div>`},Info.prototype.setExpPending=async function(t){try{return this.explorer.details=await this.node.mempool.getMeta(t),this.explorer.details||!1}catch(t){return!1}},Info.prototype.getExpPending=function(){return`(${Util.revHex(this.explorer.details.tx.txid())})`},Info.prototype.toDetails=async function(t){let e=0,n=0,o=null;const i={output:{},input:{},pending:[]};for(let e of t.inputs){if(t.isCoinbase())continue;const r=await this.node.chain.getTX(e.prevout.hash);r?o=r.outputs:(o=await this.node.mempool.getTX(e.prevout.hash).outputs,i.pending.push(`${o[e.prevout.index].getAddress()}`));const s=o[e.prevout.index].value,a=`${o[e.prevout.index].getAddress()}`;i.input[a]?i.input[a]+=s:i.input[a]=s,n+=s}for(let n of t.outputs){const t=n.script.getAddress()?`${n.script.getAddress()}`:"unknown";i.output[t]?i.output[t]+=n.value:i.output[t]=n.value,e+=n.value}return{details:i,totalin:n,totalout:e}},Info.prototype.isExpHome=function(t){this.explorer.isHome=t},Info.prototype.resetExplorer=function(){this.explorer.details=!1},Info.prototype.getInfoUpdate=function(){let t;const e=__webpack_require__(38).update,n=e.major,o=e.minor;t=`<h2>Major Update ${n.version}</h2><table>`;for(let e of n.info)t+=`<tr><td>${e}</td></tr>`;t+=`</table><h2>Minor Update ${o.version}</h2><table>`;for(let e of o.info)t+=`<tr><td>${e}</td></tr>`;return t+="</table>"},Info.prototype.getInfoClient=function getInfoClient(){let html;const OS=__webpack_require__(6),App=eval("require")("../package.json"),Core=eval("require")("../node_modules/wmcc-core/package.json");return html="<h2>Application Information</h2><table>",html+=`<tr><td>Client Name</td><td>${App.name}</td></tr>`,html+=`<tr><td>Client Version</td><td>${App.version}</td></tr>`,html+=`<tr><td>Operating System</td><td>${OS.type()} ${OS.release()} ${OS.arch()}</td></tr>`,html+=`<tr><td>Release Date</td><td>${App.release}</td></tr></table>`,html+="<h2>Core Information</h2><table>",html+=`<tr><td>Client Name</td><td>${Core.name}</td></tr>`,html+=`<tr><td>Client Version</td><td>${Core.version}</td></tr>`,html+=`<tr><td>Release Date</td><td>${Core.release}</td></tr></table>`},Info.prototype.getInfoServer=async function(){let t;const e=Core.http.Client(),n=await e.getInfo(),o=new Date(1e3*n.time.system).format("M j, Y, g:i a"),i=new Date(1e3*this.node.chain.tip.time).format("M j, Y, g:i a");return t=`<h2>General</h2><table><tr><td>Version</td><td>${n.version}</td></tr>`,t+=`<tr><td>Network</td><td>${n.network}</td></tr>`,t+=`<tr><td>Data Directory</td><td>${this.node.chain.db.options.prefix}</td></tr>`,t+=`<tr><td>Time</td><td>${o}</td></tr>`,t+=`<tr><td>Uptime</td><td>${age(n.time.uptime,!0)}</td></tr>`,t+="</table><h2>Network</h2><table>",t+=`<tr><td>Host</td><td>${n.pool.host}</td></tr>`,t+=`<tr><td>Port</td><td>${n.pool.port}</td></tr>`,t+=`<tr><td>Agent</td><td>${n.pool.agent}</td></tr>`,t+=`<tr><td>Services</td><td>${n.pool.services}</td></tr>`,t+=`<tr><td>Number of Connections</td><td>In: ${n.pool.inbound} / Out: ${n.pool.outbound}</td></tr>`,t+="</table><h2>Block Chain</h2><table>",t+=`<tr><td>Current Height</td><td>${n.chain.height}</td></tr>`,t+=`<tr><td>Last Block Time</td><td>${i}</td></tr>`,t+=`<tr><td>Progress</td><td>${(100*n.chain.progress).toFixed(2)} <a style='font-family:Ubuntu, sans-serif;'>%</a></td></tr>`,t+="</table><h2>Mempool</h2><table>",t+=`<tr><td>Number of Transactions</td><td>${n.mempool.tx}</td></tr>`,t+=`<tr><td>Memory Usage</td><td>${n.mempool.size}</td></tr></table>`},Info.prototype.getInfoPublicIP=async function(){return await Core.net.external.getIPv4()},Info.prototype.getConfigBasic=async function(){let t="";const e=this.node.config,n=e.getDefault();for(let o of Object.keys(n))if(o){t+=`<h2>${o}</h2>`;for(let i in n[o]){const r=n[o][i][0],s=n[o][i][1],a=n[o][i][2]?"":" disabled",l=n[o][i][3]?` ${n[o][i][3]}`:"",c=i.replace(/-/g,"").toLowerCase(),p=e.data[c]||r;let h;if("bool"===s){h=`<div class="checkbox${a}">\n                 <input type="checkbox" id="checkbox-${i}"${"true"===p?" checked":""}${a} name="${i}" />\n                 <label class="checkbox-off" for="checkbox-${i}"></label></div>`}else h=`<input type='text' class='${s}${l}' value='${p}'${a} name="${i}" />`;t+=`<div>${i} ${r?" (default: "+r+")":""}${h}</div>`}}return t+="<p class='result'></p><submit class=\"button s_configSave\">UPDATE</submit>"},Info.prototype.getStratumInfo=function(){let t;const e=this.node.stratum.options,n=this.node.stratum.inbound.size,o=new Date(1e3*this.node.stratum.lastActive).format("M j, Y, g:i a");return t=`<table><tr><td>Data Directory</td><td>${e.prefix}</td></tr>`,t+=`<tr><td>Public Host</td><td>${e.publicHost}</td></tr>`,t+=`<tr><td>Public Port</td><td>${e.publicPort}</td></tr>`,t+=`<tr><td>Max Inbound</td><td>${e.maxInbound}</td></tr>`,t+=`<tr><td>Difficulty</td><td>${e.difficulty}</td></tr>`,t+=`<tr><td>Last Active</td><td>${o}</td></tr>`,t+=`<tr><td>Connected Workers</td><td>${n}</td></tr></table>`},Info.prototype.getStratumUsers=function(){let t;const e=this.node.stratum.userdb;return e.size?(t="<table class='workerlist'><tr><th>Worker Name</th><th>Password</th><th>Remove Worker</th></tr>",e.map.forEach((e,n,o)=>{t+=`<tr><td>${n}</td><td>★★★★★</td>`,t+='<td><i class="glyph-icon flaticon-remove s_stratumRemoveWorker" title="Remove Worker"></i></td></tr>'}),t+="</table>"):"<table><tr><th>No worker found in userdb.</th></tr></table>"},module.exports=Info},function(t,e){},function(t,e,n){"use strict";const o=e;wmcc_core.cache=function(){},o.Browser=n(30),o.browser=n(21),o.eventbind=n(9),o.loader=n(8),o.submit=n(13),o.worker=n(35),o.window=n(4),o.credential=n(36),o.auth=n(17),o.hsm=n(10),o.otp=n(18),o.rabbit=n(24),o.Node=n(37),o.config=n(19),o.fullnode=n(25),o.hook=n(39),o.info=n(27),o.logger=n(11),o.node=n(20),o.nodeclient=n(26),o.spvnode=n(28),o.tools=n(40),o.language=n(2),o.message=n(23),o.update=n(41),o.updater=n(16),o.installer=n(12),o.utils=n(42),o.zlib=n(14),global.wmcc_desktop=o},function(t,e,n){"use strict";e.Browser=n(21),e.Window=n(4),e.Loader=n(8),e.EventBind=n(9),e.Submit=n(13)},function(t,e){t.exports=require("events")},function(t,e){t.exports=require("zlib")},function(t,e){t.exports=require("stream")},function(t,e){t.exports=require("secp256k1")},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);this.options=new i(t),this.path=this.options.path,this.file=this.options.file,this.windowOptions=this.options.window,this.window=null}function i(t){if(!(this instanceof i))return new i(t);this.window={width:300,height:300,maximizable:!1,resizable:!1,webPreferences:{devTools:!0,nodeIntegrationInWorker:!1}},this.path=null,this.file=null,this.fromOptions(t)}const r=n(1),s=n(0),a=n(7),{app:l,BrowserWindow:c}=n(3);o.prototype.start=function(){let t=this;l.on("ready",function(){t.window=new c(t.windowOptions),t.window.loadURL(a.format({pathname:s.join(__dirname,t.file),protocol:"file:",slashes:!0})),t.window.openDevTools(),t.window.on("closed",function(){t.window=null})}),l.on("window-all-closed",function(){"darwin"!==process.platform&&l.quit()}),l.on("activate",function(){null===t.window&&this.start()})},o.prototype.setPath=function(t){this.path=t},o.prototype.setFile=function(t){this.file=t},i.prototype.fromOptions=function(t){return r(t,"Options are required."),null!=t.window&&Object.assign(this.window,t.window),null!=t.path&&(r("string"==typeof t.path),this.path=t.path),null!=t.file&&(r("string"==typeof t.file),this.file=t.file),this},t.exports=o},function(t,e,n){"use strict";e.Auth=n(17),e.HSM=n(10),e.OTP=n(18)},function(t,e,n){"use strict";e.Config=n(19),e.FullNode=n(25),e.Logger=n(11),e.Node=n(20),e.SpvNode=n(28)},function(t,e){t.exports={update:{major:{version:"v2.0.0-beta.1",info:["Add WMCC Exchange","Add Built-in &amp; Standalone CLI","Add HTTP-RPC Requests","Add Receive Payment via URI","Add Languages Template","Add Restore/Backup Wallet on Cloud"]},minor:{version:"v1.1.0-beta.1",info:["Add Manage Address","Add Configuration Page","Add Notification","Update Search Transaction by Date","Update Sort Transaction by Type"]}}}},function(t,e,n){"use strict";function o(t){if(!(this instanceof o))return new o(t);this.fromNode(t),this.hook=null,this.events=[],this.init()}n(1),Core.utils.Lock;const i=Core.wmcc.Amount;o.prototype.fromNode=function(t){this.chain=t.chain,this.mempool=t.mempool,this.walletdb=t.walletdb,this.miner=t.miner,this.info=t.info},o.prototype.init=function(){const t=this,e=(e,n)=>{let o=t.events.mempool;for(let i in o)t.emit(o[i].event,"mempool",o[i].el,{tx:e,view:n})};this.mempool.listeners("tx").filter(t=>t.toString()===e.toString()).length&&this.mempool.removeAllListeners("tx",e),this.mempool.on("tx",e);const n=()=>{let e=t.events.chain;for(let n in e)t.emit(e[n].event,"chain",e[n].el)};this.chain.listeners("block").filter(t=>t.toString()===n.toString()).length&&this.chain.removeAllListeners("block",n),this.chain.on("block",n);const o=()=>{let e=t.events.balance;for(let n in e)t.emit(e[n].event,"balance",e[n].el)};this.walletdb.listeners("hook balance").filter(t=>t.toString()===o.toString()).length&&this.walletdb.removeAllListeners("hook balance",o),this.walletdb.on("hook balance",o);const i=e=>{let n=t.events.miner;for(let o in n)t.emit(n[o].event,"miner",n[o].el,{attempt:e})};this.miner.listeners("miner block").filter(t=>t.toString()===i.toString()).length&&this.miner.removeAllListeners("miner block",i),this.miner.on("miner block",i);const r=(e,n)=>{let o=t.events.notification;for(let i in o)t.emit(o[i].event,"notification",o[i].el,{block:e,entry:n,prepend:!0})};this.miner.listeners("miner found").filter(t=>t.toString()===r.toString()).length&&this.miner.removeAllListeners("miner found",r),this.miner.on("miner found",r)},o.prototype.on=async function(t,e,n,o){this.events[e]||(this.events[e]=[]);const i={event:t,el:n};return this.events[e].filter((e,o)=>e.event===t||e.el===n).length||this.events[e].push(i),this.events[e]=this.events[e].map(t=>Object.assign(t,[i].find(e=>e&&t.event===e.event))),await this.emit(t,e,n,o)},o.prototype.add=async function(t,e,n,o){return await this.on(t,e,n,o)},o.prototype.emit=async function(t,e,n,o){try{let i;return i=o&&Object.keys(o).length?await this[t](...Object.values(o)):await this[t](),void(o&&o.append?n.append(i):o&&o.prepend?n.prepend(i):n.html(i))}catch(n){if("TypeError"!==n.name)throw n;console.log(`Unable to hook 'on' event for ${e}::${t}`)}},o.prototype.getBalance=async function(){return await this.info.wallet.getBalanceDetails(this.info.getAccountName())},o.prototype.getTotal=async function(t){const e=t||await this.getBalance();return i.text(e.total)},o.prototype.getAvailable=async function(t){const e=t||await this.getBalance();return i.text(e.available)},o.prototype.getPending=async function(t){const e=t||await this.getBalance();return i.text(e.pending)},o.prototype.getImmature=async function(t){const e=t||await this.getBalance();return i.text(e.immature)},o.prototype.getRecentTransactions=async function(){let t,e="";try{t=await this.info.wallet.getLast(this.info.wallet.account.name,5)}catch(t){return`<h2>${t}</h2>`}for(let n of t){n=await this.info.wallet.toDetails(n);const t=new Date(1e3*n.mtime).format("d-m-Y");let o=0,r=null;for(let t of n.inputs)t.path&&(o+=t.value,r="out"),0===n.time&&(r="out sending");if(o){o=0;for(let t of n.outputs)t.path||(o+=t.value,r="out")}else{for(let t of n.outputs)t.path&&(o+=t.value,r="in");0===n.time&&(r="in receiving"),n.tx.isCoinbase()&&(r="rig")}e+=`<holder><i class="glyph-icon flaticon-${r}"></i><span>`,e+=`<label>${t}</label><label>${i.wmcc(o,!0)} wmcc</label>`,e+=`<a><label class='r_goToExp' value="${n.hash}">Show Details</label></a></span></holder>`}return e||"<holder><h2>No recent transaction found.</h2></holder>"},o.prototype.getUnconfirmTxCount=function(){return this.mempool.getCount()},o.prototype.getUnconfirmTxSize=function(){return function(t){return t<1048576?(t/1024).toFixed(3):t<1073741824?(t/1024).toFixed(0):void 0}(this.mempool.getSize())},o.prototype.getLatestTxs=function(t,e){let n="";if(t){const e=[t.hash("hex"),t.getOutputValue()];if(!this._latesttxs.indexOf(e))return;this._latesttxs.push(e)}else this._latesttxs=[],this.mempool.map.forEach((t,e)=>{this._latesttxs.push([e,t.value])});const o=this._latesttxs.length,r=this._latesttxs.slice(Math.max(0,o-5),o);if(r.length){n+="<table>";for(let t=r.length-1;t>=0;t--)n+=`<tr><td><a title='${r[t][0]}' class='r_goToExp'>${r[t][0]}<a></td>`,n+=`<td>${i.wmcc(r[t][1],!0)}</td></tr>`;n+="</table>"}else n="<h2>No transaction in mempool.</h2>";return n},o.prototype.getCurrentBlock=async function(){let t="";const e=this.chain.height,n=this.chain.tip.rhash(),o=await this.chain.getEntry(e),r=await this.chain.getBlock(o.hash);return t+="<table>",t+=`<tr><td>Tip</td><td colspan='3'><a title='${n}'>${n}</a></td></tr>`,t+=`<tr><td>Hash</td><td colspan='3'><a title='${o.rhash()}' class='r_goToExp'>${o.rhash()}</a></td></tr>`,t+=`<tr><td>Height</td><td>${e}</td>`,t+=`<td>Age</td><td>${function(t,e){let n=e?t:Math.abs(Date.now()/1e3-t),o="",i={},r=0;const s={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};return Object.keys(s).forEach(function(t){i[t]=Math.floor(n/s[t]),n-=i[t]*s[t],i[t]&&r<1&&(r++,o+=` ${i[t]} ${t}${i[t]>1?"s":""}`)}),`${o}${e?"":" ago"}`}(o.time)}</td></tr>`,t+=`<tr><td>Txns<a></td><td>${r.txs.length}</td>`,t+=`<td>Outputs</td><td>${i.wmcc(r.getClaimed())} wmcc</td></tr>`,t+=`<tr><td>Size</td><td>${r.getVirtualSize()/1e3} kb</td>`,t+=`<td>Weight</td><td>${r.getWeight()/1e3} kwu</td></tr>`},o.prototype.destroy=async function(){},o.prototype.getMinerInfo=function(t){this._getMinerInfo&&!t&&(t=this._getMinerInfo);let e="<table>";return t?(this._getMinerInfo=t,e+=`<tr><td>Address</td><td colspan="3"><a title='${t.address}' class='r_goToExp'>${t.address}</a></td></tr>`,e+=`<tr><td>Height</td><td>${t.height}</td><td>Fees</td><td>${i.wmcc(t.fees)} wmcc</td></tr>`,e+=`<tr><td>Transactions</td><td>${t.items.length+1}</td><td>Difficulty</td><td>${function(t){let e=t>>>24&255,n=65535/(16777215&t);for(;e<29;)n*=256,e++;for(;e>29;)n/=256,e--;return n}(t.bits)}</td></tr>`):e+=`<tr><td colspan="2" class="ellipse">Address: ${this.info.getAddress()}</td></tr>`,e+="<table>"},o.prototype.minerFoundBlock=function(t,e){if("object"!=typeof t)return;let n="";return n+='<table class=\'minerfound\'><tr><th rowspan="3"><i class="glyph-icon flaticon-remove"></i><i class="glyph-icon flaticon-rig"></i></th>',n+='<th colspan="2">Found New Block!</th></tr>',n+=`<tr><td>Block height</td><td>: ${e.height}</td></tr>`,n+=`<tr><td>Block reward</td><td>: ${i.wmcc(t.txs[0].outputs[0].value)} wmcc</td></tr></table>`},t.exports=o},function(t,e,n){"use strict";e.Language=n(2)},function(t,e,n){"use strict";e.Updater=n(16),e.Installer=n(12)},function(t,e,n){"use strict";e.Zlib=n(14)}]);